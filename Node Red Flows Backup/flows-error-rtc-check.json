[
    {
        "id": "4bd3f7a138ab9bf8",
        "type": "tab",
        "label": "SIMFS",
        "disabled": false,
        "info": ""
    },
    {
        "id": "153fc0026305c5a8",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Generate IMG Zip & CSV",
        "style": {
            "stroke": "#000000",
            "label": true,
            "fill": "#bfdbef",
            "fill-opacity": "0.5",
            "color": "#000000"
        },
        "nodes": [
            "a85ec6cdccb5bbd4",
            "d5d20f4fc1571949",
            "14532f7c737dafcf",
            "5ce4f439bef7d9ec",
            "3f14afc581bd7433",
            "3b3f9f9888431d82",
            "f6d6bd93484967cf",
            "da099d713da4bb10",
            "0ff5e6377e477a97",
            "c75ffc16e51f4c85",
            "763c9b5233441649",
            "a261db631a9f278d",
            "a66dc15b26fac9d5",
            "5cbb54f590a041ac",
            "ec08b5cb0ee33eaa",
            "3c15dcd6616e0995",
            "1d5c105e7d84579f",
            "0c3d2b26b256d05e",
            "138d4cb55b3879ba",
            "df10633359171271",
            "939d34b570b6c9ee",
            "4b9fd0ce9af12507",
            "14287ac166a88472",
            "fc603d7ddc8f5224"
        ],
        "x": 344,
        "y": 1199,
        "w": 1082,
        "h": 442
    },
    {
        "id": "0e300cd91d605c57",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Estetica del Dashboard",
        "style": {
            "fill": "#6f2fa0",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "3e8428c3a3bec3df",
            "3a4b0df31f26fbf0",
            "85055e61f8e0cc69",
            "1a40f8c17378a453",
            "628f390d20262f22",
            "b3d29b303cd5b4be",
            "ee322519e8af21cb",
            "cb3055868453f2d6",
            "35f721fb75cef445"
        ],
        "x": 2474,
        "y": 79,
        "w": 652,
        "h": 262
    },
    {
        "id": "0f2a2139fe8d7ca1",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Current Data Values",
        "style": {
            "fill": "#e3f3d3",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "dcfe392f41be09ec",
            "32f2f0528ac57a5f",
            "a0d8bd9d82a110af",
            "35b1c97f59fd9704",
            "3d07738b4f1aa41c",
            "600e54a52fa1509b",
            "ef32280e152b2d7c",
            "6b8951eba85a1386",
            "4a61374005642b4b",
            "919b936bbb8109c5",
            "5ca3955143dc7c09"
        ],
        "x": 1634,
        "y": 1671.5,
        "w": 672,
        "h": 289.5
    },
    {
        "id": "a5289a68db4611d8",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "",
        "style": {
            "fill": "#e3f3d3",
            "label": true,
            "fill-opacity": "0.5",
            "stroke": "#000000"
        },
        "nodes": [
            "475203b1e692e997",
            "5c6426371e884326",
            "bd33a6264a2e800f",
            "a64225f81539ca82",
            "e44c401448606848",
            "c26f796f7ad0778f",
            "68c2c6391f9d4f9c",
            "c8e1e2b64fbbae34"
        ],
        "x": 1754,
        "y": 79,
        "w": 692,
        "h": 262
    },
    {
        "id": "d8498c485785607b",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Video Stream",
        "style": {
            "fill": "#b797cf",
            "fill-opacity": "0.5",
            "label": true,
            "stroke": "#000000",
            "color": "#000000"
        },
        "nodes": [
            "83997dd4544a0198",
            "0900b6a64aa894b5",
            "eec915a79c477847",
            "2c25c785d8f14147",
            "66d370d20ff8f92e",
            "f9733d95b262a0d0",
            "bcacec41f62711e2",
            "b76fc0abf17b011c",
            "ba9a1cb3744a2249",
            "6dc346f7e9d5ac14",
            "40afbc6ab376fe63",
            "03a881d61c35e8fe",
            "9f7f69a595bcb587",
            "5c81477eabc10c1c",
            "a8865b9e2ca35101",
            "b0324bc31c51dfa5",
            "bc430912b533d2cc",
            "ba56abc75de9eade",
            "de89378993b205b2"
        ],
        "x": 2634,
        "y": 1359,
        "w": 1292,
        "h": 282
    },
    {
        "id": "ef4d0af07249ef87",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Take Data Periodic",
        "style": {
            "fill": "#ffbfbf",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "ad50af1c77ca6229",
            "3aed26a91dbaecf0",
            "4956872f8e5b87ce",
            "d1fb36ac9e21e0c6",
            "c60e2529787e2803",
            "2a321ba98578a3b7",
            "463c7e1c7cc8791d",
            "4de2905cb6f4fd89",
            "561712e4b8e43c43",
            "220233ad3436d22a",
            "af831710c2f29c8d",
            "d6bf6c0d1939afe5",
            "906710fb8b9a7298",
            "42db76d7b88b039e",
            "626b960698c625cb"
        ],
        "x": 2774,
        "y": 359,
        "w": 632,
        "h": 329.5
    },
    {
        "id": "82a28149466e2b45",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "File Manager",
        "style": {
            "stroke": "#000000",
            "fill": "#ffefbf",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "7263e044f37728bd",
            "ca2e56985aed1ae2",
            "6db138eb55fa6436",
            "6d2322b1bf89e5d8"
        ],
        "x": 1468,
        "y": 1313,
        "w": 1124,
        "h": 334
    },
    {
        "id": "2b12209bde62c41d",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Bird Detection",
        "style": {
            "stroke": "#000000",
            "fill": "#addb7b",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "b369e0bef35431d5",
            "aedcc0fe2d6ddfc3",
            "63afb30e53636433",
            "be652780821319f6",
            "c44274b883a43fdb",
            "465ad214e60db578",
            "198b2a54cc5f84c6",
            "52a16677e5520568",
            "de22f55d806e2135",
            "198486085c4d822c",
            "6d5b87c926301923",
            "20adaf6731cb0f94",
            "669a57d6344b3a51",
            "748efb437466a4f4"
        ],
        "x": 2014,
        "y": 1059,
        "w": 1052,
        "h": 222
    },
    {
        "id": "b28fbac2d58cd3cf",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "On Reload",
        "style": {
            "fill": "#ff0000",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "158dea50af251ddc",
            "b872425e4cc5d3ca",
            "15b0d6fbbb1a4621",
            "5a05de41f5ad5301",
            "d14754268887d998",
            "c8caecc46da13eb1",
            "2e7ddfebe958c635",
            "c1d45c05dcc2f331",
            "910278e5e8f63c15"
        ],
        "x": 1414,
        "y": 739,
        "w": 462,
        "h": 202
    },
    {
        "id": "9fa822970d0e02a2",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Flow Variables And RTC",
        "style": {
            "fill": "#ffC000",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "3c71823641439b97",
            "c6a9736beb8ca4a1",
            "621f31c2387df55f",
            "a2f33f0decdeeb7e",
            "02bfb4fbc2df5ea5",
            "a2ec51133add780f"
        ],
        "x": 1934,
        "y": 539,
        "w": 592,
        "h": 169.5
    },
    {
        "id": "3a9c760f97d8aca9",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Configuración",
        "style": {
            "fill": "#ffcf3f",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000",
            "stroke": "#000000"
        },
        "nodes": [
            "ad2daa0daf214307",
            "714fc8ea8a3eadc5",
            "7ec8debd1be24785",
            "7d4232130a08490a",
            "a275167bbe0d1ca0",
            "d0eece487dd898ae",
            "ca662e9811d45aba",
            "1a5b94b69b728773",
            "1332655bda5e8126",
            "48d8edec9aedd8f9",
            "424e283f6a8b7971",
            "6aacb923b80940e3",
            "3f8c9ee0edfd1aed",
            "fdbfe6346fc78968",
            "1ebf9405058aacec",
            "5993b0fd2a06a714",
            "d1dfd51ff7688da8",
            "b722117212951963"
        ],
        "x": 2344,
        "y": 1679,
        "w": 862,
        "h": 422
    },
    {
        "id": "38b2e4140c614a54",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Date Manager",
        "style": {
            "stroke": "#000000",
            "fill": "#ffbfbf",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "4789b2a4961fd39c",
            "487302c17ac70c69",
            "41303a729b281d8c",
            "009eb7a08b8f1d4f",
            "5359da4031524f2e",
            "0a6f3b8e1ebb393c",
            "462404854100f1af",
            "7347cb65ebc131db",
            "63b8d6ff13f59204"
        ],
        "x": 344,
        "y": 1673,
        "w": 1258,
        "h": 414
    },
    {
        "id": "b04f466bf94de283",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Read From File Last Time Data",
        "style": {
            "stroke": "#000000",
            "fill": "#dbcbe7",
            "fill-opacity": "0.4",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "f0f7068830d8bb5a",
            "b6de08c6dbd52d64",
            "fe232b59628bb1e3",
            "ab19c6983b4d19d5",
            "dadd83795049ff57",
            "5799c7c643a4ddd7",
            "3a2542022481af0f"
        ],
        "x": 1944,
        "y": 759,
        "w": 502,
        "h": 162
    },
    {
        "id": "0ee206c8ef765709",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Show Bird Presence",
        "style": {
            "stroke": "#000000",
            "fill": "#ffefbf",
            "label": true,
            "color": "#000000",
            "fill-opacity": "0.5"
        },
        "nodes": [
            "8d39a11b2b0c66a2",
            "95a10332743c4a8e",
            "428c7be7b578af87",
            "c43218c63003d980",
            "63c90edf1fc0b5c5",
            "4fedabf67f0c7fe4",
            "e49f02fd88eb7bfd",
            "bfa63315e2663064",
            "6f3ae68f41a73c5f"
        ],
        "x": 554,
        "y": 2119,
        "w": 832,
        "h": 122
    },
    {
        "id": "90ef18f8b38770c1",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Save Bird Presence",
        "style": {
            "stroke": "#000000",
            "fill": "#0070c0",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "21bf379491b3b12b",
            "7c7cf62d4bba59de",
            "a2ed3487bb11f95f",
            "3def40830c4ec2ba",
            "c1a2cc44f4c758e7"
        ],
        "x": 2694,
        "y": 859,
        "w": 352,
        "h": 162
    },
    {
        "id": "55ea67ed8f6efe15",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Bird Trajectory Graph",
        "style": {
            "stroke": "#000000",
            "fill": "#6f2fa0",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "b13896a2f12a15f2",
            "564585eb.ab740c",
            "b868cd58.8d414",
            "37f3892b.89a456",
            "f6b8d38e3af54de5",
            "362f7dc1cb0b61b5",
            "e986bd4ab3fef777",
            "61a3e16978134041",
            "7e6237bf49335dbc",
            "69f11c096294323f"
        ],
        "x": 1414,
        "y": 2119,
        "w": 532,
        "h": 222
    },
    {
        "id": "e4d1dce20abccbef",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Bird Data",
        "style": {
            "label": true,
            "stroke": "#000000",
            "fill": "#e3f3d3",
            "fill-opacity": "0.5",
            "color": "#000000"
        },
        "nodes": [
            "603126b806f758d3",
            "44e27602f907a70b",
            "ca82df86ea757a04",
            "9461d19020cb1c5a"
        ],
        "x": 3094,
        "y": 1139,
        "w": 412,
        "h": 122
    },
    {
        "id": "d38a2bbf9d27a11c",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Photo Filter Debug",
        "style": {
            "stroke": "#ff0000",
            "fill": "#ff0000",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "b10999fbcd8fea55",
            "42e81d3672620c1a",
            "c6a3a6353abeed1d",
            "d939fd86d2496767",
            "6c8fafe779723f25",
            "14091502ce1dda92",
            "73c01fbb82760324"
        ],
        "x": 1334,
        "y": 2499,
        "w": 512,
        "h": 229.5
    },
    {
        "id": "d08f9a2c4e6b9e9b",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "Reboot Node Red",
        "style": {
            "stroke": "#000000",
            "fill": "#e3f3d3",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "0d0875ef01a75d96",
            "abf294cc6d0f2417",
            "3d6ce2d1d07ebbb9",
            "a0aa0247a6243420",
            "a1d4aa1ed5dc2310",
            "12d5c7559df89c2f",
            "608c40df0e9ca09d",
            "1131c53852adac45",
            "152f105603eccf50"
        ],
        "x": 554,
        "y": 2279,
        "w": 512,
        "h": 262
    },
    {
        "id": "7263e044f37728bd",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "82a28149466e2b45",
        "name": "",
        "style": {
            "fill": "#3f93cf",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "44221866a43c189e",
            "d472f537a6fb0cff",
            "f060d9832f5eab1f",
            "18f244a18bcecd30",
            "7776152e5f61c2b4",
            "b4f7dbc11561c9a4"
        ],
        "x": 1794,
        "y": 1339,
        "w": 752,
        "h": 142
    },
    {
        "id": "ca2e56985aed1ae2",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "82a28149466e2b45",
        "name": "",
        "style": {
            "fill": "#dbcbe7",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "c352c4dad2601f2b",
            "73a081a14edd129f",
            "74fc3a458a5fc865",
            "dfb93ee228d91f49",
            "5419390f44bd7d25",
            "34efba9cba4dcbf1"
        ],
        "x": 1494,
        "y": 1379,
        "w": 272,
        "h": 242
    },
    {
        "id": "6db138eb55fa6436",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "82a28149466e2b45",
        "name": "",
        "style": {
            "stroke": "#777777",
            "label": true,
            "fill": "#ff3f3f",
            "fill-opacity": "0.5"
        },
        "nodes": [
            "3e1edb4a9699e970",
            "4f2e571d9c60103a",
            "51382fe237a14d37",
            "30edd8636b58c908",
            "659dd377658b5f9b"
        ],
        "x": 1794,
        "y": 1499,
        "w": 772,
        "h": 122
    },
    {
        "id": "5359da4031524f2e",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "",
        "style": {
            "fill": "#ffff7f",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "f1be12d6cd818d02",
            "a938137a58472e46",
            "b767dbd5a1685857",
            "0731df5759089676",
            "30e079efb57dec7f",
            "fb2dd40f5d756dbd",
            "610da4e4e817e3bb"
        ],
        "x": 764,
        "y": 1699,
        "w": 252,
        "h": 362
    },
    {
        "id": "0a6f3b8e1ebb393c",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "",
        "style": {
            "fill": "#addb7b",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "7f763d8a1cf9b132",
            "ca6d33cc46bb1d90",
            "a5ea1275479e4107",
            "e43b37cc9f8b7107",
            "055bef59dda0482c",
            "209647a33910046e"
        ],
        "x": 544,
        "y": 1739,
        "w": 192,
        "h": 322
    },
    {
        "id": "462404854100f1af",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "",
        "style": {
            "fill": "#ff7f7f",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "941f5e0a89a8d99b",
            "0d76ee4ca04c3dc8",
            "f616f00dc5c6adc5"
        ],
        "x": 1324,
        "y": 1819,
        "w": 252,
        "h": 162
    },
    {
        "id": "7347cb65ebc131db",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "",
        "style": {
            "fill": "#ffdf7f",
            "fill-opacity": "0.5",
            "label": true
        },
        "nodes": [
            "2ccd72f009dcdb1a",
            "430e260f73a371bb",
            "eb0daa897167e3eb",
            "ff4af9e483865444"
        ],
        "x": 1064,
        "y": 1719,
        "w": 232,
        "h": 322
    },
    {
        "id": "7c86f6078e91083c",
        "type": "group",
        "z": "4bd3f7a138ab9bf8",
        "name": "RTC Restart Notification",
        "style": {
            "stroke": "#000000",
            "fill": "#dbcbe7",
            "fill-opacity": "0.5",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "d638eef8be7f1dc8",
            "674ef304a2ca14b2",
            "f4dbec9993651d14",
            "f8dab95a90ac6799",
            "50da0b27953103d8",
            "6dfdf11c017fee5f",
            "2b1bbe4391992523"
        ],
        "x": 2534,
        "y": 719,
        "w": 852,
        "h": 122
    },
    {
        "id": "c26f796f7ad0778f",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "Set base path",
        "func": "//restrict to c:\\temp\\\nvar basePath = \"/home/pi/simfs/simfs_export_data/\";\nvar filename = msg.req.params.fn;\n\nif(filename.includes(\"..\\\\\")){\n    msg.payload = \"Illegal file path\";\n    msg.statusCode = 405;//not allowed\n    return [null, msg];//fire output 2\n} else if(filename.includes(\"../\")){\n    msg.payload = \"Illegal file path\";\n    msg.statusCode = 405;//not allowed\n    return [null, msg];//fire output 2\n} \n//TODO: add more checks\n\nmsg.filename = basePath + filename;\nreturn [msg, null];//fire output 1",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2060,
        "y": 180,
        "wires": [
            [
                "68c2c6391f9d4f9c"
            ],
            [
                "c8e1e2b64fbbae34"
            ]
        ]
    },
    {
        "id": "c8e1e2b64fbbae34",
        "type": "http response",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 2370,
        "y": 220,
        "wires": []
    },
    {
        "id": "68c2c6391f9d4f9c",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "",
        "filename": "filename",
        "filenameType": "msg",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2230,
        "y": 160,
        "wires": [
            [
                "c8e1e2b64fbbae34"
            ]
        ]
    },
    {
        "id": "bd33a6264a2e800f",
        "type": "catch",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 1840,
        "y": 260,
        "wires": [
            [
                "e44c401448606848",
                "a64225f81539ca82"
            ]
        ]
    },
    {
        "id": "e44c401448606848",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "Set 404",
        "func": "msg.payload = msg.error;\nmsg.statusCode = 404;//resource not found\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2220,
        "y": 260,
        "wires": [
            [
                "c8e1e2b64fbbae34"
            ]
        ]
    },
    {
        "id": "a64225f81539ca82",
        "type": "debug",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1870,
        "y": 300,
        "wires": []
    },
    {
        "id": "475203b1e692e997",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "Create http endpoint <nodered>/files/xxx  where xxx is the file name to download",
        "info": "",
        "x": 2060,
        "y": 120,
        "wires": []
    },
    {
        "id": "5c6426371e884326",
        "type": "http in",
        "z": "4bd3f7a138ab9bf8",
        "g": "a5289a68db4611d8",
        "name": "",
        "url": "/files/:fn",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 1850,
        "y": 180,
        "wires": [
            [
                "c26f796f7ad0778f"
            ]
        ]
    },
    {
        "id": "dcfe392f41be09ec",
        "type": "ui_gauge",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Current Lum",
        "group": "e09affd1d78f162d",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "donut",
        "title": "Luminosidad actual",
        "label": "Lux",
        "format": "{{value}}",
        "min": 0,
        "max": "300",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "100|",
        "seg2": "200",
        "className": "",
        "x": 2210,
        "y": 1840,
        "wires": []
    },
    {
        "id": "32f2f0528ac57a5f",
        "type": "ui_gauge",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Current Temp",
        "group": "e09affd1d78f162d",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "donut",
        "title": "Temperatura actual",
        "label": "°C",
        "format": "{{value}}",
        "min": "-15",
        "max": "40",
        "colors": [
            "#151ce0",
            "#bbddf7",
            "#ed0202"
        ],
        "seg1": "0",
        "seg2": "15",
        "className": "",
        "x": 2200,
        "y": 1880,
        "wires": []
    },
    {
        "id": "a0d8bd9d82a110af",
        "type": "ui_gauge",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Current Hum",
        "group": "e09affd1d78f162d",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "donut",
        "title": "Humedad actual",
        "label": "Humedad Relativa",
        "format": "{{value}}%",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "33",
        "seg2": "66",
        "className": "",
        "x": 2210,
        "y": 1920,
        "wires": []
    },
    {
        "id": "35b1c97f59fd9704",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Set Actual Values",
        "func": "var lum_ = { payload: msg.payload.lum };\nflow.set('lastLum', msg.payload.lum);\n\nvar temp_ = { payload: msg.payload.temp };\nif (temp_.payload != 999) {    \n    flow.set('lastTemp', temp_.payload);\n} else {    \n    temp_.payload = flow.get('lastTemp') || 0;\n}\n\nvar hum_ = { payload: msg.payload.hum };\nif (hum_.payload != 999) {\n    flow.set('lastHum', hum_.payload);\n} else {\n    hum_.payload = flow.get('lastHum') || 0;\n}\n\n\nreturn [lum_, temp_, hum_];",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1990,
        "y": 1880,
        "wires": [
            [
                "dcfe392f41be09ec"
            ],
            [
                "32f2f0528ac57a5f"
            ],
            [
                "a0d8bd9d82a110af"
            ]
        ]
    },
    {
        "id": "3d07738b4f1aa41c",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Read LastData.json",
        "filename": "/home/pi/LastData/last_data.json",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2010,
        "y": 1780,
        "wires": [
            [
                "600e54a52fa1509b",
                "ef32280e152b2d7c"
            ]
        ]
    },
    {
        "id": "600e54a52fa1509b",
        "type": "json",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": true,
        "x": 1970,
        "y": 1820,
        "wires": [
            [
                "35b1c97f59fd9704"
            ]
        ]
    },
    {
        "id": "3e8428c3a3bec3df",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "group": "",
        "name": "Head - Template",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n    /*\n    Pre-defined colors\n    */\n    :root {\n        --color-link-text-dark: rgba(241, 153, 226, 1);\n        --color-link-text-light: rgb(243, 44, 44, 1);\n        --color-link-text: var(--color-link-text-light);\n        \n        --color-toolbar-text-dark: rgba(255, 255, 255, 1);\n        --color-toolbar-text-light: rgb(0, 0, 0, 1);\n        --color-toolbar-text: var(--color-toolbar-text-light);\n        \n        --color-main-dark:  rgba(75, 121, 48, 1);\n        --color-main-light:  rgba(250, 253, 144, 1);\n        --color-main: var(--color-main-light);\n        \n        --color-text-light: rgba(104, 107, 0, 1);\n        --color-text-dark: rgba(109, 176, 70, 1);\n        --color-text: var(--color-text-light);\n        \n        --color-card-light: rgba(250, 250, 233, 1);\n        --color-card-dark: rgba(51, 51, 51, 1);\n        --color-card: var(--color-card-light);\n        \n        --color-widget-border: rgb(84, 78, 78);\n        --color-widget-trans: rgba(178, 178, 178, 0.2);\n        \n        --color-button-light: rgba(188, 194, 54, 0.8);\n        --color-button-dark: rgba(75, 121, 48, 0.8);\n        --color-button: var(--color-button-light);\n        \n        --color-button-text-light: rgba(0, 0, 0, 0.8);\n        --color-button-text-dark: rgba(255, 255, 255, 0.8);\n        --color-button-text: var(--color-button-text-light);\n        \n        --color-button-background-light: rgba(155, 158, 24, 1);\n        --color-button-background-dark: rgba(109, 176, 70, 1);\n        --color-button-background: var(--color-button-background-light);\n        \n        --color-selection-light: rgba(100,100,155,1);\n        --color-selection-dark: rgba(154,116,116,0.8);\n        --color-selection: var(--color-selection-light);\n        \n        --color-tint-light: rgba(182, 182, 255,1);\n        --color-tint-dark: rgba(255, 182, 182,1);\n        --color-tint: var(--color-tint-light);\n        \n        --color-gauge-light: rgba(155, 158, 24, 1);/*(182, 187, 9, 0.8);*/\n        --color-gauge-dark: rgba(165, 231, 138, 0.8);\n        --color-gauge: var(--color-gauge-light);\n        \n        --color-background-primary-light: rgba(239, 243, 136, 1);/*rgba(250, 253, 144, 1);*/\n        --color-background-secondary-light: rgba(255, 255, 255, 1);\n        \n        --color-background-primary-dark: rgba(44, 73, 26, 0.5);\n        --color-background-secondary-dark: rgba(82, 159, 35, 0.5);\n        \n        --color-background-primary: var(--color-background-primary-light);\n        --color-background-secondary: var(--color-background-secondary-light);\n\n        --color-toolbar-background-light: rgba(239, 243, 136, 0.7);\n        --color-toolbar-background-dark: rgba(44, 73, 26, 0.7);\n        --color-toolbar-background: var(--color-toolbar-background-light);\n\n        --color-numeric-node-background-light: rgba(255, 255, 255, 1);\n        --color-numeric-node-background-dark: rgba(17, 17, 17, 1);\n        --color-numeric-node-background: var(--color-numeric-node-background-light);\n\n        --color-numeric-node-text-light: rgba(17, 17, 17, 1);\n        --color-numeric-node-text-dark: rgba(255, 255, 255, 1);\n        --color-numeric-node-text: var(--color-numeric-node-text-light);\n        \n    }\n\n    /*Numeric Nodes*/\n    .nr-dashboard-theme .nr-dashboard-numeric .value {\n        background-color: var(--color-numeric-node-background);\n        color: var(--color-numeric-node-text);\n    }\n\n    /*Left Toolbar*/\n    .nr-menu-item-active div button {\n        border-right-color: var(--color-text);\n    }\n    body.nr-dashboard-theme md-sidenav {\n        color: var(--color-text);\n        background-color: var(--color-toolbar-background);\n    }\n    body.nr-dashboard-theme md-sidenav div.md-list-item-inner {\n        color: var(--color-text);\n    }\n    /*Toolbar gradient*/\n    md-toolbar#toolbar{\n        background: var(--color-main);\n        /*linear-gradient(120deg, var(--color-main) 20%, var(--color-background-secondary) 100%);*/ \n    }\n    /*Toolbar text*/\n    body.nr-dashboard-theme md-toolbar .md-toolbar-tools {\n        color: var(--color-toolbar-text);\n    }\n    /*Group name*/\n    .nr-dashboard-theme ui-card-panel p.nr-dashboard-cardtitle {\n        color: var(--color-text);\n    }\n    /*Gauge number and units*/\n    .nr-dashboard-theme .nr-dashboard-gauge text {\n        fill: var(--color-gauge);\n        margin: 8px;\n    }\n    /*Background*/\n    .masonry-container {\n        position: relative;\n        width: 100%;\n        height:100%;\n        margin: 0 auto;\n        background: linear-gradient(180deg,  var(--color-background-primary) 0%, var(--color-background-secondary) 100%); \n    }\n    /*Group color*/\n    .nr-dashboard-theme ui-card-panel {\n        background-color: #333333FF;\n        color:var(--color-text);\n        border-radius: 10px;\n        box-shadow: 0 0 8px 0px #00000080;\n    }\n    .nr-dashboard-theme .nr-dashboard-button .md-button  {\n        background: var(--color-button-background);\n        color:var(--color-button-text);\n    }\n    /*Widget color and text: necesito que el alpha sea 0 así se copia el color del card*/\n    body.nr-dashboard-theme md-content md-card {\n        background-color: #00000000;\n        color: var(--color-text);\n    }\n    /*Widget date text color*/\n    .nr-dashboard-theme .nr-dashboard-date-picker md-input-container .md-input {\n        color: var(--color-text);\n    }\n    /*ol color: necesito que el alpha sea 0 así se copia el color del card*/\n    .nr-dashboard-theme .nr-dashboard-template {\n        background-color: #33333300;\n    }\n    /*Card color*/\n    .nr-dashboard-theme ui-card-panel {\n        background-color: var(--color-card);\n        color: var(--color-text);\n    }\n    /*Date picker original date: necesito que el alpha sea 0*/\n    .md-datepicker-calendar-pane.md-pane-open {\n        background-color: #ffffff00;\n    }\n    /*Date picker header color*/\n    .md-default-theme .md-calendar-day-header, .md-calendar-day-header {\n        color: var(--color-text);\n        background-color: var(--color-background-primary);\n    }\n    /*Date picker day color*/\n    .md-default-theme .md-calendar-date.md-calendar-selected-date .md-calendar-date-selection-indicator, .md-calendar-date.md-calendar-selected-date .md-calendar-date-selection-indicator, .md-default-theme .md-calendar-date.md-focus.md-calendar-selected-date .md-calendar-date-selection-indicator, .md-calendar-date.md-focus.md-calendar-selected-date .md-calendar-date-selection-indicator {\n        background: var(--color-background-primary);\n        color: var(--color-text);\n        border-color: transparent;\n    }\n    /*Date picker actual date border*/\n    .md-default-theme .md-calendar-date.md-calendar-date-today .md-calendar-date-selection-indicator, .md-calendar-date.md-calendar-date-today .md-calendar-date-selection-indicator {\n        border: 1px solid var(--color-background-primary);\n    }\n    /*Date picker icon*/\n    .nr-dashboard-theme .nr-dashboard-date-picker .md-button.md-icon-button md-icon {\n        color: var(--color-text);\n    }\n    /*Date picker underline*/\n    .nr-dashboard-theme md-input-container.md-default-theme .md-input, md-input-container .md-input {\n        border-color: var(--color-text) !important;\n    }\n    \n    /*Button*/\n    .nr-dashboard-theme .nr-dashboard-button .md-button {\n        background: var(--color-button);\n        color: var(--color-button-text);\n    }\n    .nr-dashboard-theme .nr-dashboard-button .md-button {\n        background-color: var(--color-button);\n        color: white;\n    }\n    /*Button shadow*/\n    .nr-dashboard-theme .nr-dashboard-button .md-button:hover {\n        background-color: var(--color-button-background);\n    }\n    a:link{\n        color: var(--color-link-text);\n    }\n</style>\n\n<script id=\"headScript\" type=\"text/javascript\">\n    /*\n    Javascript to inject UI elements into the top of all dashboards (head)\n    */\n    var clockInterval;\n    $(function () {\n        if (clockInterval) return;\n\n        //add logo\n        var div0 = $('<div/>');\n        var logo = new Image();\n        logo.src = \"data:image/gif;base64,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\"\n        logo.height = 45;\n\n        div0[0].style.margin = '10px auto';\n        div0[0].style.width = '100px';\n        div0[0].style.float = 'left';\n\n        div0.append(logo);\n        \n        \n        //add clock\n        var div1 = $('<div/>');\n        var p = $('<p/>');\n\n        div1.append(p);\n        div1[0].style.margin = '5px';\n        div1[0].style.width = '120px';\n        div1[0].style.float = 'right';\n\n        function displayTime() {\n            p.text(new Date().toLocaleTimeString());\n        }\n        \n        //add day/night mode button\n        var div2 = $('<div/>');\n        var button = document.createElement('BUTTON');\n        var html = document.getElementsByTagName('html')[0];\n        var elem = window.getComputedStyle(html);\n        var night_icon = document.createElement(\"night\");\n        var day_icon = document.createElement(\"day\");\n        day_icon.className =\"fa fa-moon-o\";\n        night_icon.className =\"fa fa-sun-o\";\n        button.appendChild(night_icon);\n        button.onclick = function(){\n            button.replaceChild((button.firstChild.nodeName == \"NIGHT\") ? day_icon : night_icon, (button.firstChild.nodeName == \"DAY\") ? day_icon : night_icon);\n            html.style.setProperty(\"--color-main\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-main-light\") : elem.getPropertyValue(\"--color-main-dark\"));\n            html.style.setProperty(\"--color-text\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-text-light\") : elem.getPropertyValue(\"--color-text-dark\"));\n            html.style.setProperty(\"--color-button\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-button-light\") : elem.getPropertyValue(\"--color-button-dark\"));\n            html.style.setProperty(\"--color-gauge\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-gauge-light\") : elem.getPropertyValue(\"--color-gauge-dark\"));\n            html.style.setProperty(\"--color-selection\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-selection-light\") : elem.getPropertyValue(\"--color-selection-dark\"));\n            html.style.setProperty(\"--color-tint\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-tint-light\") : elem.getPropertyValue(\"--color-tint-dark\"));\n            html.style.setProperty(\"--color-background-primary\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-background-primary-light\") : elem.getPropertyValue(\"--color-background-primary-dark\"));\n            html.style.setProperty(\"--color-background-secondary\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-background-secondary-light\") :elem.getPropertyValue(\"--color-background-secondary-dark\"));\n            html.style.setProperty(\"--color-card\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-card-light\") :elem.getPropertyValue(\"--color-card-dark\"));\n            html.style.setProperty(\"--color-button-background\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-button-background-light\") :elem.getPropertyValue(\"--color-button-background-dark\"));\n            html.style.setProperty(\"--color-button-text\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-button-text-light\") :elem.getPropertyValue(\"--color-button-text-dark\"));\n            html.style.setProperty(\"--color-toolbar-text\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-toolbar-text-light\") :elem.getPropertyValue(\"--color-toolbar-text-dark\"));\n            \n            html.style.setProperty(\"--color-link-text\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-link-text-light\") :elem.getPropertyValue(\"--color-link-text-dark\"));\n\n            html.style.setProperty(\"--color-toolbar-background\",(button.firstChild.nodeName == \"NIGHT\") ?\n            elem.getPropertyValue(\"--color-toolbar-background-light\") :elem.getPropertyValue(\"--color-toolbar-background-dark\"));\n\n            html.style.setProperty(\"--color-numeric-node-background\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-numeric-node-background-light\") :elem.getPropertyValue(\"--color-numeric-node-background-dark\"));\n\n            html.style.setProperty(\"--color-numeric-node-text\",(button.firstChild.nodeName == \"NIGHT\") ? elem.getPropertyValue(\"--color-numeric-node-text-light\") :elem.getPropertyValue(\"--color-numeric-node-text-dark\"));\n        }\n\n        div2[0].style.margin = '5px auto';\n        div2[0].style.width = '60px';\n        div2[0].style.float = 'right';\n        button.tooltip = 'Cambia entre los temas oscuro (dark) y claro (light).';\n        button.style.color = elem.getPropertyValue(\"--color-widget\");\n        button.style.background = elem.getPropertyValue(\"--color-widget-trans\");\n        button.style.borderRadius = '20%';\n        div2.append(button);\n        \n        clockInterval = setInterval(displayTime, 1000);\n\n        //add to toolbar when it's available\n        var addToToolbarTimer;\n        \n        function addToToolbar() {\n            var toolbar = $('.md-toolbar-tools');\n            \n            if(!toolbar.length) return;\n            \n            toolbar.append(div0);\n            toolbar.append(div1);\n            toolbar.append(div2);\n            clearInterval(addToToolbarTimer);\n        }\n        addToToolbarTimer = setInterval(addToToolbar, 100);\n    });\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "global",
        "className": "",
        "x": 3020,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "3a4b0df31f26fbf0",
        "type": "http in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "",
        "url": "/upload_simfs_ico",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 2600,
        "y": 180,
        "wires": [
            [
                "85055e61f8e0cc69"
            ]
        ]
    },
    {
        "id": "85055e61f8e0cc69",
        "type": "template",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<h1>Upload a file here:</h1>\n\n<form action=\"/upload\" method=\"POST\" enctype=\"multipart/form-data\">\n    <input type=\"file\" name=\"myFile\" />\n    <input type=\"submit\" value=\"Submit\">\n</form>",
        "output": "str",
        "x": 2890,
        "y": 180,
        "wires": [
            [
                "1a40f8c17378a453"
            ]
        ]
    },
    {
        "id": "1a40f8c17378a453",
        "type": "http response",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "",
        "x": 3050,
        "y": 180,
        "wires": []
    },
    {
        "id": "628f390d20262f22",
        "type": "http response",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "",
        "x": 3050,
        "y": 300,
        "wires": []
    },
    {
        "id": "b3d29b303cd5b4be",
        "type": "http in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "",
        "url": "/get_simfs_ico_path",
        "method": "post",
        "upload": true,
        "swaggerDoc": "",
        "x": 2610,
        "y": 240,
        "wires": [
            [
                "cb3055868453f2d6"
            ]
        ]
    },
    {
        "id": "ee322519e8af21cb",
        "type": "template",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<p></p>File {{name}} uploaded !</p>\n\n<h2>Contents:</h2>\n\n<pre>\n{{{payload}}}\n</pre>",
        "output": "str",
        "x": 2870,
        "y": 300,
        "wires": [
            [
                "628f390d20262f22"
            ]
        ]
    },
    {
        "id": "cb3055868453f2d6",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "toBase64",
        "func": "msg.name = msg.req.files[0].originalname;\n\nif (msg.req.files[0].mimetype.includes('image')) {\n    msg.payload = `<img src=\"data:image/gif;base64,${msg.req.files[0].buffer.toString('base64')}\">`;\n} else {\n    msg.payload = msg.req.files[0].buffer.toString();\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2900,
        "y": 240,
        "wires": [
            [
                "ee322519e8af21cb"
            ]
        ]
    },
    {
        "id": "35f721fb75cef445",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "0e300cd91d605c57",
        "name": "Colors and Theme",
        "info": "Head - Tempalte:\nSetea colores de cada tema, icono, hora y botón para switchear el theme.\n\nEl resto de los nodos:\nNo tengo ni idea de como subir la imagen al src, uso estos path para subirla y generar un link. Eso lo coloco en el head template y lo coloco.",
        "x": 2590,
        "y": 120,
        "wires": []
    },
    {
        "id": "a85ec6cdccb5bbd4",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Reload Data Lum",
        "group": "6aaf1c6d6ce702b7",
        "order": 1,
        "width": 8,
        "height": 1,
        "passthru": true,
        "label": "Refrescar Datos de Luminosidad",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 1240,
        "wires": [
            [
                "ec08b5cb0ee33eaa"
            ]
        ]
    },
    {
        "id": "d5d20f4fc1571949",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "command": "cd /home/pi/simfs/simfs_export_data/ && sudo rm Datos_Fotos.zip && sudo zip -J Datos_Fotos.zip",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "30",
        "winHide": true,
        "oldrc": false,
        "name": "Zip Png",
        "x": 760,
        "y": 1560,
        "wires": [
            [],
            [],
            [
                "df10633359171271"
            ]
        ]
    },
    {
        "id": "14532f7c737dafcf",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1270,
        "y": 1520,
        "wires": []
    },
    {
        "id": "5ce4f439bef7d9ec",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Create Files Path Img",
        "func": "let zipAvailable = flow.get('makingZip') || 0;\nlet png_array = flow.get('png_array') || 0;\n\nif (zipAvailable && png_array.length !=0) {\n    flow.set('makingZip', false);\n    var png_arr = flow.get('png_array');\n    var png_st = \"\";\n\n    for (let i = 0; i < png_arr.length; i++) {\n        png_st = png_st + png_arr[i] + \" \";\n    }\n    png_st = png_st.slice(0, -1);\n    var png_ = { payload: png_st };\n\n    return png_;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 1560,
        "wires": [
            [
                "d5d20f4fc1571949",
                "138d4cb55b3879ba"
            ]
        ]
    },
    {
        "id": "3f14afc581bd7433",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Download Png",
        "group": "6aaf1c6d6ce702b7",
        "order": 5,
        "width": 8,
        "height": 1,
        "passthru": false,
        "label": "Descargar Compilado Imágenes",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 500,
        "y": 1520,
        "wires": [
            [
                "5ce4f439bef7d9ec"
            ]
        ]
    },
    {
        "id": "c75ffc16e51f4c85",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Reload Data TyH",
        "group": "6aaf1c6d6ce702b7",
        "order": 3,
        "width": 8,
        "height": 1,
        "passthru": true,
        "label": "Refrescar Datos de Temp. Y Hum.",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 1460,
        "wires": [
            [
                "3c15dcd6616e0995"
            ]
        ]
    },
    {
        "id": "ef32280e152b2d7c",
        "type": "trigger",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "",
        "op1": "dc",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-11",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1910,
        "y": 1720,
        "wires": [
            [
                "6b8951eba85a1386"
            ]
        ]
    },
    {
        "id": "3b3f9f9888431d82",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Generate Lum Update",
        "func": "var msgfail = {payload: \"Error al generar CSV de Luminosidad.\"};\n\nif(flow.get('lum_valid_date')) {\n    var from_ = flow.get('lum_from_date') || 0;\n    var to_ = flow.get('lum_to_date') || 0;\n    var variable_ = 2;//\"lum\";\n    \n    from_ += \"_00:00\";\n    to_ += \"_23:59\";\n    \n    msg.payload = \"--start_time=\\\"\" + from_ + \"\\\" --end_time=\\\"\" + to_ + \"\\\" --meas_type=\" + variable_;\n    msgfail = { payload: \"\" };\n} else {\n    msg = { payload: \"\" };\n}\n\nreturn [msg, msgfail];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 1280,
        "wires": [
            [
                "763c9b5233441649"
            ],
            [
                "5cbb54f590a041ac"
            ]
        ]
    },
    {
        "id": "763c9b5233441649",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "command": "cd /home/pi/simfs/Python_Scripts/Clases/ && python3 make_csv_cli.py",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "30",
        "winHide": false,
        "oldrc": false,
        "name": "Python3 Make CSV",
        "x": 1310,
        "y": 1280,
        "wires": [
            [
                "6d2322b1bf89e5d8"
            ],
            [],
            []
        ]
    },
    {
        "id": "0ff5e6377e477a97",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "command": "cd /home/pi/simfs/simfs_export_data/ && rm TemperaturaYHumedad_*",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "5",
        "winHide": false,
        "oldrc": false,
        "name": "Delete Old TyH CSV",
        "x": 780,
        "y": 1380,
        "wires": [
            [
                "a66dc15b26fac9d5"
            ],
            [],
            []
        ]
    },
    {
        "id": "da099d713da4bb10",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "command": "cd /home/pi/simfs/simfs_export_data/ && rm Luminosidad_*",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "5",
        "winHide": false,
        "oldrc": false,
        "name": "Delete Old Lum CSV",
        "x": 780,
        "y": 1320,
        "wires": [
            [
                "a261db631a9f278d"
            ],
            [],
            []
        ]
    },
    {
        "id": "f6d6bd93484967cf",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Generate TyH Update",
        "func": "var msgfail = {payload: \"Error al generar CSV de Temperatura y Humedad.\"};\nif(flow.get('tyh_valid_date')) {\n    var from_ = flow.get('tyh_from_date') || 0;\n    var to_ = flow.get('tyh_to_date') || 0;\n    var variable_ = 1;//\"tyh\";\n    \n    from_ += \"_00:00\";\n    to_ += \"_23:59\";\n    \n    msg.payload = \"--start_time=\\\"\" + from_ + \"\\\" --end_time=\\\"\" + to_ + \"\\\" --meas_type=\" + variable_;\n    msgfail = { payload: \"\" };\n} else {\n    msg = { payload: \"\" };\n}\n\nreturn [msg, msgfail];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 1420,
        "wires": [
            [
                "763c9b5233441649"
            ],
            [
                "5cbb54f590a041ac"
            ]
        ]
    },
    {
        "id": "a261db631a9f278d",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "group": "c63655b8f7450c5c",
        "name": "Delete Lum",
        "order": 6,
        "width": 0,
        "height": 0,
        "format": "<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {\n    if (msg) {\n      let menu_lum = document.getElementById('Lum_list');\n      while (menu_lum.firstChild) {\n        menu_lum.removeChild(menu_lum.firstChild);\n      }\n    }    \n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1030,
        "y": 1320,
        "wires": [
            [
                "3b3f9f9888431d82"
            ]
        ]
    },
    {
        "id": "a66dc15b26fac9d5",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "group": "c63655b8f7450c5c",
        "name": "Delete TyH",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {\n    if (msg) {\n      let menu_tyh = document.getElementById('tyh_list');\n      while (menu_tyh.firstChild) {\n        menu_tyh.removeChild(menu_tyh.firstChild);\n      }\n    }    \n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1030,
        "y": 1380,
        "wires": [
            [
                "f6d6bd93484967cf"
            ]
        ]
    },
    {
        "id": "6dc346f7e9d5ac14",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Set Stream URL",
        "func": "var new_payload = \"data:image/gif;base64,\" + msg.payload;\nmsg.payload = new_payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3740,
        "y": 1480,
        "wires": [
            [
                "f9733d95b262a0d0"
            ]
        ]
    },
    {
        "id": "ba9a1cb3744a2249",
        "type": "base64",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 3840,
        "y": 1400,
        "wires": [
            [
                "6dc346f7e9d5ac14"
            ]
        ]
    },
    {
        "id": "bcacec41f62711e2",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Set Stream URL",
        "func": "if (msg.payload == \"\") {\n    msg.payload = \"/home/pi/simfs/NidoImagesFrontEnd/end-stream-img.png\";\n    return [msg, null];\n}\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3500,
        "y": 1400,
        "wires": [
            [
                "b76fc0abf17b011c"
            ],
            [
                "f9733d95b262a0d0"
            ]
        ]
    },
    {
        "id": "b76fc0abf17b011c",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "filename": "payload",
        "filenameType": "msg",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 3700,
        "y": 1400,
        "wires": [
            [
                "ba9a1cb3744a2249"
            ]
        ]
    },
    {
        "id": "83997dd4544a0198",
        "type": "ui_iframe",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "group": "e09affd1d78f162d",
        "name": "",
        "order": 14,
        "width": 13,
        "height": 10,
        "url": "",
        "origin": "*",
        "scale": 100,
        "x": 3830,
        "y": 1580,
        "wires": [
            []
        ]
    },
    {
        "id": "0900b6a64aa894b5",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "group": "e09affd1d78f162d",
        "order": 5,
        "width": 3,
        "height": 2,
        "passthru": true,
        "label": "Ver el nido en vivo",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "El stream finalizará en 5 minutos.",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 3030,
        "y": 1560,
        "wires": [
            [
                "9f7f69a595bcb587"
            ]
        ]
    },
    {
        "id": "eec915a79c477847",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "command": "python3 /home/pi/simfs/Python_Scripts/stream.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "300",
        "winHide": false,
        "oldrc": false,
        "name": "Python3 Camera Stream",
        "x": 3410,
        "y": 1460,
        "wires": [
            [
                "bcacec41f62711e2"
            ],
            [],
            [
                "03a881d61c35e8fe"
            ]
        ]
    },
    {
        "id": "2c25c785d8f14147",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 3390,
        "y": 1560,
        "wires": []
    },
    {
        "id": "66d370d20ff8f92e",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Set Stream URL",
        "func": "msg.payload = \"http://192.168.0.10:8000/\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3380,
        "y": 1600,
        "wires": [
            [
                "f9733d95b262a0d0"
            ]
        ]
    },
    {
        "id": "f9733d95b262a0d0",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "set URL",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3660,
        "y": 1580,
        "wires": [
            [
                "83997dd4544a0198"
            ]
        ]
    },
    {
        "id": "6b8951eba85a1386",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "command": "cd /home/pi/simfs/Python_Scripts/ && python3 getRTMeasurements.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "10",
        "winHide": false,
        "oldrc": false,
        "name": "Update Python Function",
        "x": 2150,
        "y": 1720,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "40afbc6ab376fe63",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Connect",
        "func": "if (msg.payload == \"connect\") {\n    msg.payload = \"\";\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3180,
        "y": 1400,
        "wires": [
            [
                "bcacec41f62711e2"
            ]
        ]
    },
    {
        "id": "5cbb54f590a041ac",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Filter Notification",
        "func": "var msgFailLum = \"Error al generar CSV de Luminosidad.\";\nvar msgFailTyH =  \"Error al generar CSV de Temperatura y Humedad.\";\n\nif ((msg.payload == msgFailLum) || (msg.payload == msgFailTyH)) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 1420,
        "wires": [
            [
                "14532f7c737dafcf"
            ]
        ]
    },
    {
        "id": "ec08b5cb0ee33eaa",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Check Lum Valid Date",
        "func": "if (flow.get('lum_valid_date') || 0) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1280,
        "wires": [
            [
                "14287ac166a88472"
            ]
        ]
    },
    {
        "id": "3c15dcd6616e0995",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Check TyH Valid Date",
        "func": "if (flow.get('tyh_valid_date') || 0) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1420,
        "wires": [
            [
                "fc603d7ddc8f5224"
            ]
        ]
    },
    {
        "id": "44221866a43c189e",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "name": "CSV Parser",
        "info": "CSV Lister toma todos los *.csv. Lum filter y TyH filter seleccionan las mediciones de cada varialbe para que los ui_templates los coloquen en su adecuado lugar.",
        "x": 1890,
        "y": 1380,
        "wires": []
    },
    {
        "id": "d472f537a6fb0cff",
        "type": "fs-file-lister",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "name": "CSV Lister",
        "start": "/home/pi/simfs/simfs_export_data/",
        "pattern": "*.csv",
        "folders": "*",
        "hidden": false,
        "lstype": "files",
        "path": false,
        "single": true,
        "depth": 0,
        "stat": false,
        "showWarnings": false,
        "x": 1890,
        "y": 1420,
        "wires": [
            [
                "7776152e5f61c2b4",
                "b4f7dbc11561c9a4"
            ]
        ]
    },
    {
        "id": "f060d9832f5eab1f",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "group": "f44b173abdb7e275",
        "name": "ui_temlplate - Lum",
        "order": 3,
        "width": 8,
        "height": 6,
        "format": "<ul id='Lum_list'>\n    \n</ul>\n<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {\n    \n    let newContent = document.createElement(\"li\", style = \"color:red;\");    \n    let list = document.getElementById('Lum_list');   \n\n    while (list.childElementCount) {\n      list.removeChild(list.firstChild);\n    }\n\n    let link = document.createElement(\"a\", style = \"color:red;\");\n    newContent.appendChild(link);\n    \n    if (msg.payload == 'Empty Folder') {\n      link.textContent = \"No hay archivos CSV disponibles para descargar. Refrescar la página.\";\n      list.appendChild(newContent);\n    } else {\n      link.href = \"/files/\" + msg.payload;\n      link.textContent = \"Descargar \" + msg.payload;\n      list.appendChild(newContent);\n    }\n    \n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 2430,
        "y": 1400,
        "wires": [
            []
        ]
    },
    {
        "id": "18f244a18bcecd30",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "group": "4ad91a62eed23859",
        "name": "ui_temlplate - TyH",
        "order": 3,
        "width": 8,
        "height": 6,
        "format": "<ul id='tyh_list'>\n    \n</ul>\n<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {        \n    let newContent = document.createElement(\"li\", style = \"color:red;\");\n    let list = document.getElementById('tyh_list');\n    \n    while (list.childElementCount) {\n      list.removeChild(list.firstChild);\n    }\n    \n    let link = document.createElement(\"a\", style = \"color:red;\");\n    newContent.appendChild(link);\n    \n    if(msg.payload == 'Empty Folder'){\n      link.textContent = \"No hay archivos CSV disponibles para descargar. Refrescar la página.\";\n      list.appendChild(newContent);\n    } else {\n      link.href = \"/files/\" + msg.payload;\n      link.textContent = \"Descargar \" + msg.payload;\n      list.appendChild(newContent);\n    }\n\n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 2430,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "7776152e5f61c2b4",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "name": "Filter Lum CSV",
        "func": "//Luminosidad_2022-09-30_2022-10-01.csv\nvar array = [];\narray = msg.payload;\n\nfor (let i = 0; i < array.length; i++) {\n    var current = array[i];\n    if (current.includes('Lum')) {        \n        var fileFrom = current.split(\"_\")[1];\n        var fileTo = current.split(\"_\")[2];\n        fileTo = fileTo.split(\".\")[0];\n\n        var calendarFrom = flow.get('lum_from_date') || 0;\n        var calendarTo = flow.get('lum_to_date') || 0;\n\n        var checkFrom = checkTimes(calendarFrom, fileFrom);\n        var checkTo = checkTimes(fileTo, calendarTo);\n\n        if (checkFrom && checkTo) {\n            return { payload: current };\n        } else {\n            return { payload: 'Empty Folder' };\n        }\n    }    \n}\n\nreturn { payload: 'Empty Folder' }\n\nfunction checkTimes(first_string, second_string) {\n    //Returns True if second >= first\n\n    var first = new Date(first_string);\n    var second = new Date(second_string);\n\n    var difference = second.getTime() - first.getTime();\n    return difference >= 0;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2120,
        "y": 1400,
        "wires": [
            [
                "f060d9832f5eab1f"
            ]
        ]
    },
    {
        "id": "b4f7dbc11561c9a4",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7263e044f37728bd",
        "name": "Filter TyH CSV",
        "func": "var null_msg = { payload: 'Empty Folder' };\n\nvar temp_invalid_date = false;\nvar array = [];\narray = msg.payload;\nfor (let i = 0; i < array.length; i++) {\n    var current = array[i];\n    if (current.includes('Temp')) {\n        var fileFrom = current.split(\"_\")[1];\n        var fileTo = current.split(\"_\")[2];\n        fileTo = fileTo.split(\".\")[0];\n        var calendarFrom = flow.get('lum_from_date') || 0;\n        var calendarTo = flow.get('lum_to_date') || 0;\n        var checkFrom = checkTimes(calendarFrom, fileFrom);\n        var checkTo = checkTimes(fileTo, calendarTo);\n\n        if (checkFrom && checkTo) {\n            return { payload: current };\n        } else {\n            return { payload: 'Empty Folder' };\n        }\n    }\n}\n\nfunction checkTimes(first_string, second_string) {\n    //Returns True if second >= first\n\n    var first = new Date(first_string);\n    var second = new Date(second_string);\n\n    var difference = second.getTime() - first.getTime();\n    return difference >= 0;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2120,
        "y": 1440,
        "wires": [
            [
                "18f244a18bcecd30"
            ]
        ]
    },
    {
        "id": "c352c4dad2601f2b",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "group": "c63655b8f7450c5c",
        "name": "Delete",
        "order": 3,
        "width": 0,
        "height": 0,
        "format": "<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {\n    if (msg) {\n      if (flow.get('lum_valid_date') || 0) {\n        let menu_lum = document.getElementById('Lum_list');\n        while (menu_lum.firstChild) {\n          menu_lum.removeChild(menu_lum.firstChild);\n        }\n      }\n  \n      if (flow.get('tyh_valid_date') || 0) {\n        let menu_tyh = document.getElementById('tyh_list');\n        while (menu_tyh.firstChild) {\n          menu_tyh.removeChild(menu_tyh.firstChild);\n        }\n      }\n  \n      if (flow.get('png_valid_date') || 0) {\n        let menu_png = document.getElementById('png_list');\n        while (menu_png.firstChild) {\n          menu_png.removeChild(menu_png.firstChild);\n        }\n      }\n    }    \n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1630,
        "y": 1500,
        "wires": [
            [
                "5419390f44bd7d25"
            ]
        ]
    },
    {
        "id": "73a081a14edd129f",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "name": "Reload Data",
        "group": "6aaf1c6d6ce702b7",
        "order": 6,
        "width": 8,
        "height": 1,
        "passthru": true,
        "label": "Refrescar Todos Los Datos",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "connect",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1590,
        "y": 1460,
        "wires": [
            [
                "c352c4dad2601f2b"
            ]
        ]
    },
    {
        "id": "74fc3a458a5fc865",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "name": "Button System - F5 - Init",
        "info": "Botón que recarga los datos. Limita los clicks al botón, elimina los archivos que ya están cargados y genera un payload que la siguiente función interprete como mun update",
        "x": 1630,
        "y": 1420,
        "wires": []
    },
    {
        "id": "3e1edb4a9699e970",
        "type": "fs-file-lister",
        "z": "4bd3f7a138ab9bf8",
        "g": "6db138eb55fa6436",
        "name": "PNG Lister",
        "start": "/home/pi/simfs/simfs_export_data/",
        "pattern": "*.png",
        "folders": "*",
        "hidden": false,
        "lstype": "files",
        "path": false,
        "single": true,
        "depth": 0,
        "stat": false,
        "showWarnings": false,
        "x": 2090,
        "y": 1580,
        "wires": [
            [
                "51382fe237a14d37"
            ]
        ]
    },
    {
        "id": "4f2e571d9c60103a",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "6db138eb55fa6436",
        "name": "Image Parser",
        "info": "Busca archivos *.png y los carga en el grupo de imágenes.",
        "x": 1890,
        "y": 1540,
        "wires": []
    },
    {
        "id": "51382fe237a14d37",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "6db138eb55fa6436",
        "name": "Filter PNG",
        "func": "//Imagen_2021-10-20_20:35:21.png\nvar current = msg.payload;\nvar fromDate = 'png_from_date';\nvar toDate = 'png_to_date';\n\nvar array = [];\nvar toReturn = [];\narray = msg.payload;\nfor (let i = 0; i < array.length; i++) {\n    if (array[i] != 'Empty Folder' && checkDates(array[i], fromDate, toDate)) {\n        toReturn.push(array[i]);\n    }\n}\n\nflow.set('png_array', toReturn);\nif (toReturn.length == 0){    \n    return { payload: ['Empty Folder'] };\n} else {\n    return { payload: toReturn };\n}\n\nfunction checkDates(current, fromDate, toDate) {\n\n    //take msg date\n    var fileDateYMD = current.split(\"_\")[1];\n    var fileYear = parseInt(fileDateYMD.split(\"-\")[0]);\n    var fileMonth = parseInt(fileDateYMD.split(\"-\")[1]);\n    var fileDay = parseInt(fileDateYMD.split(\"-\")[2]);\n\n    //take calendar dates\n    var calendar_first = flow.get(fromDate) || 0;\n    var minYear = parseInt(calendar_first.split('-')[0]);\n    var minMonth = parseInt(calendar_first.split('-')[1]);\n    var minDay = parseInt(calendar_first.split('-')[2]);\n\n    var calendar_second = flow.get(toDate) || 0;\n    var maxYear = parseInt(calendar_second.split('-')[0]);\n    var maxMonth = parseInt(calendar_second.split('-')[1]);\n    var maxDay = parseInt(calendar_second.split('-')[2]);\n\n    var year_min = minYear < fileYear;\n    var year_min_same = minYear == fileYear;\n    var month_min = minMonth < fileMonth;\n    var month_min_same = minMonth == fileMonth;\n    var day_min = minDay <= fileDay;\n    var min_check = year_min || (year_min_same && month_min) || (year_min_same && month_min_same && day_min);\n\n    var year_max = fileYear < maxYear;\n    var year_max_same = fileYear == maxYear;\n    var month_max = fileMonth < maxMonth;\n    var month_max_same = fileMonth == maxMonth;\n    var day_max = fileDay <= maxDay;\n    var max_check = year_max || (year_max_same && month_max) || (year_max_same && month_max_same && day_max);\n\n    return min_check && max_check;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2270,
        "y": 1580,
        "wires": [
            [
                "30edd8636b58c908"
            ]
        ]
    },
    {
        "id": "30edd8636b58c908",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "6db138eb55fa6436",
        "group": "ed493faf50b74f04",
        "name": "ui_temlplate - PNG",
        "order": 3,
        "width": 8,
        "height": 6,
        "format": "<ol id='png_list'>\n    \n</ol>\n<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {    \n    let array = [];\n    array = msg.payload;\n\n    let list = document.getElementById('png_list');\n    while (list.firstChild) {\n      list.removeChild(list.firstChild);\n    }\n\n    for (let i = 0; i < array.length; i++) {\n      let newContent = document.createElement(\"li\", style = \"color:red;\");\n      let link = document.createElement(\"a\", style = \"color:red;\");\n      newContent.appendChild(link);\n      //let list = document.getElementById('png_list');\n\n      if (array[i] == 'Empty Folder') {\n        link.textContent = \"No hay archivos PNG disponibles para descargar. Refrescar la página.\";\n        list.appendChild(newContent);\n      } else if (array[i] != \"Empty Folder\") {\n        link.href = \"/files/\" + array[i];\n        link.textContent = \"Descargar \" + array[i];\n        list.appendChild(newContent);        \n      }\n      \n    }\n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 2450,
        "y": 1580,
        "wires": [
            []
        ]
    },
    {
        "id": "659dd377658b5f9b",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "6db138eb55fa6436",
        "name": "",
        "pauseType": "rate",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1910,
        "y": 1580,
        "wires": [
            [
                "3e1edb4a9699e970"
            ]
        ]
    },
    {
        "id": "b369e0bef35431d5",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "command": "cd /home/pi/BLEdetection/ && sudo python3 presenceDetector.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "29",
        "winHide": false,
        "oldrc": false,
        "name": "Presence Detector Py",
        "x": 2320,
        "y": 1140,
        "wires": [
            [
                "aedcc0fe2d6ddfc3",
                "748efb437466a4f4"
            ],
            [],
            []
        ]
    },
    {
        "id": "aedcc0fe2d6ddfc3",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "Presence Detector",
        "func": "var birdInNest = msg.payload.slice(0, -1) === 'True';\n\nvar return_notif = { payload: \"¡Acába de llegar el pájaro!\" };\nvar return_string = { payload: \"¡El pájaro está en el nido!\" };\nvar return_png = { payload: \"/home/pi/simfs/NidoImagesFrontEnd/bird_home.png\" };\n\nif (!birdInNest) {\n    return_notif = { payload: \"El pájaro se fue a pasear :(\" };\n    return_string = { payload: \"El pájaro no está en casa.\" };\n    return_png = { payload: \"/home/pi/simfs/NidoImagesFrontEnd/bird_away.png\" };\n}\n\nif (birdInNest == (flow.get('bird_presence') || 0)) {\n    return_notif = null;\n} else {\n    flow.set('bird_presence', birdInNest);\n}\n\nreturn [return_notif, return_string, return_png];",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2550,
        "y": 1140,
        "wires": [
            [
                "63afb30e53636433",
                "c1a2cc44f4c758e7"
            ],
            [
                "669a57d6344b3a51"
            ],
            [
                "465ad214e60db578"
            ]
        ]
    },
    {
        "id": "63afb30e53636433",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2950,
        "y": 1120,
        "wires": []
    },
    {
        "id": "be652780821319f6",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "Set Stream URL",
        "func": "var new_payload = \"data:image/gif;base64,\" + msg.payload;\nmsg.payload = new_payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2700,
        "y": 1240,
        "wires": [
            [
                "198b2a54cc5f84c6"
            ]
        ]
    },
    {
        "id": "c44274b883a43fdb",
        "type": "base64",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "",
        "action": "str",
        "property": "payload",
        "x": 2920,
        "y": 1200,
        "wires": [
            [
                "be652780821319f6"
            ]
        ]
    },
    {
        "id": "465ad214e60db578",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "",
        "filename": "payload",
        "filenameType": "msg",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2780,
        "y": 1200,
        "wires": [
            [
                "c44274b883a43fdb"
            ]
        ]
    },
    {
        "id": "198b2a54cc5f84c6",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "set URL",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2860,
        "y": 1240,
        "wires": [
            [
                "52a16677e5520568"
            ]
        ]
    },
    {
        "id": "52a16677e5520568",
        "type": "ui_iframe",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "group": "e09affd1d78f162d",
        "name": "",
        "order": 9,
        "width": 1,
        "height": 2,
        "url": "",
        "origin": "*",
        "scale": "10",
        "x": 2990,
        "y": 1240,
        "wires": [
            []
        ]
    },
    {
        "id": "de22f55d806e2135",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "First Time",
        "func": "flow.set('bird_presence', false);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2100,
        "y": 1200,
        "wires": [
            [
                "6d5b87c926301923"
            ]
        ]
    },
    {
        "id": "198486085c4d822c",
        "type": "trigger",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-30",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 2430,
        "y": 1220,
        "wires": [
            [
                "b369e0bef35431d5"
            ]
        ]
    },
    {
        "id": "20adaf6731cb0f94",
        "type": "ui_ui_control",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "",
        "events": "all",
        "x": 2100,
        "y": 1240,
        "wires": [
            [
                "6d5b87c926301923"
            ]
        ]
    },
    {
        "id": "6d5b87c926301923",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "Connect",
        "func": "if (msg.payload == \"connect\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2260,
        "y": 1220,
        "wires": [
            [
                "198486085c4d822c"
            ]
        ]
    },
    {
        "id": "03a881d61c35e8fe",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Set PyCamera State",
        "func": "if ((msg.payload.signal == \"SIGTERM\") || (msg.payload.code == 0))  {\n    flow.set('pyCamera', true);\n} else {\n    flow.set('pyCamera', false);\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3400,
        "y": 1520,
        "wires": [
            []
        ]
    },
    {
        "id": "9f7f69a595bcb587",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Check PyCamera State",
        "func": "if (flow.get('pyCamera') || 0) {\n    flow.set('pyCamera', false);\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2970,
        "y": 1600,
        "wires": [
            [
                "2c25c785d8f14147",
                "66d370d20ff8f92e",
                "eec915a79c477847"
            ]
        ]
    },
    {
        "id": "6d2322b1bf89e5d8",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "82a28149466e2b45",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1610,
        "y": 1360,
        "wires": [
            [
                "d472f537a6fb0cff"
            ]
        ]
    },
    {
        "id": "158dea50af251ddc",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "connect",
        "payloadType": "str",
        "x": 1520,
        "y": 780,
        "wires": [
            [
                "5a05de41f5ad5301",
                "910278e5e8f63c15"
            ]
        ]
    },
    {
        "id": "b872425e4cc5d3ca",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "Connect",
        "func": "if (msg.payload == \"connect\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 860,
        "wires": [
            [
                "5a05de41f5ad5301",
                "d14754268887d998"
            ]
        ]
    },
    {
        "id": "15b0d6fbbb1a4621",
        "type": "ui_ui_control",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "",
        "events": "all",
        "x": 1520,
        "y": 900,
        "wires": [
            [
                "b872425e4cc5d3ca"
            ]
        ]
    },
    {
        "id": "5a05de41f5ad5301",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1710,
        "y": 820,
        "wires": [
            [
                "c1d45c05dcc2f331",
                "621f31c2387df55f",
                "de22f55d806e2135"
            ]
        ]
    },
    {
        "id": "d14754268887d998",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1710,
        "y": 860,
        "wires": [
            [
                "2e7ddfebe958c635"
            ]
        ]
    },
    {
        "id": "c8caecc46da13eb1",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "Init",
        "mode": "link",
        "links": [
            "009eb7a08b8f1d4f",
            "096ab37867f77f7f",
            "69f11c096294323f",
            "3eb236bbd6ebf2f1"
        ],
        "x": 1835,
        "y": 780,
        "wires": []
    },
    {
        "id": "2e7ddfebe958c635",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "F5",
        "mode": "link",
        "links": [
            "82a381ae78aa0945",
            "4b9951d701dbdeb1",
            "5ca3955143dc7c09",
            "6dfdf11c017fee5f"
        ],
        "x": 1835,
        "y": 860,
        "wires": []
    },
    {
        "id": "dfb93ee228d91f49",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "name": "Init And F5: File Manager",
        "links": [
            "c1d45c05dcc2f331"
        ],
        "x": 1535,
        "y": 1500,
        "wires": [
            [
                "c352c4dad2601f2b"
            ]
        ]
    },
    {
        "id": "5419390f44bd7d25",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "name": "",
        "pauseType": "delay",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1650,
        "y": 1540,
        "wires": [
            [
                "d472f537a6fb0cff",
                "659dd377658b5f9b"
            ]
        ]
    },
    {
        "id": "c1d45c05dcc2f331",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "Init and F5",
        "mode": "link",
        "links": [
            "dfb93ee228d91f49",
            "5c81477eabc10c1c",
            "dbf6f22ba6029033",
            "7817fa4e62459c5e",
            "c61d761bd60a9b6f",
            "b0e30bd948caf516",
            "d0eece487dd898ae",
            "919b936bbb8109c5",
            "3a2542022481af0f"
        ],
        "x": 1835,
        "y": 820,
        "wires": []
    },
    {
        "id": "1d5c105e7d84579f",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Reload Data Lum: Button",
        "links": [
            "4789b2a4961fd39c",
            "4de2905cb6f4fd89"
        ],
        "x": 385,
        "y": 1240,
        "wires": [
            [
                "a85ec6cdccb5bbd4"
            ]
        ]
    },
    {
        "id": "0c3d2b26b256d05e",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Reload Data TyH: Button",
        "links": [
            "463c7e1c7cc8791d",
            "487302c17ac70c69"
        ],
        "x": 385,
        "y": 1460,
        "wires": [
            [
                "c75ffc16e51f4c85"
            ]
        ]
    },
    {
        "id": "669a57d6344b3a51",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "group": "e09affd1d78f162d",
        "name": "Bird Detection Text",
        "order": 8,
        "width": 6,
        "height": 2,
        "format": "<style>\n  ol { text-align: center; }\n</style>\n\n<strong style=\"overflow:hidden;vertical-align:top;\">\n  <ol id='show_bird_state_text' style=\"color:--color-text;font-size:25px;overflow:hidden;\">\n    Esperando posición...\n  </ol>\n</strong>\n\n<script>\n(function(scope) {\n  scope.$watch('msg', function(msg) {    \n    let element = document.getElementById('show_bird_state_text');\n    element.textContent = msg.payload;    \n  });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 2810,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "ad50af1c77ca6229",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Last Photo Time",
        "func": "if (msg.payload == true) {    \n    var currentTime = flow.get('timeRTC') || 0;\n    currentTime = currentTime.split('_')[0] + 'T' + currentTime.split('_')[1];\n    flow.set('lastFotoTaken', currentTime);\n\n    var file_name = flow.get('timeRTC').replace(/:/g, '-');\n    var toReturn = { payload: '-o Imagen_' + file_name + '.png' };\n\n    var lum = flow.get('lastLum') || 0;\n    var photoNight = flow.get('photoNight') || 0;\n\n    if (photoNight && (lum < 20) ) {\n        toReturn.payload = '-ex night ' + toReturn.payload;\n    }\n\n    return toReturn;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2900,
        "y": 440,
        "wires": [
            [
                "3aed26a91dbaecf0",
                "d6bf6c0d1939afe5"
            ]
        ]
    },
    {
        "id": "3aed26a91dbaecf0",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "command": "cd /home/pi/simfs/simfs_export_data/ && raspistill -w 640 -h 480 -n -q 50 -v ",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "30",
        "winHide": false,
        "oldrc": false,
        "name": "Take Photo",
        "x": 3110,
        "y": 440,
        "wires": [
            [
                "626b960698c625cb"
            ],
            [],
            []
        ]
    },
    {
        "id": "138d4cb55b3879ba",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Comprimiendo imagenes...",
        "func": "return { payload: \"Comprimiendo imagenes. Esto puede tardar unos minutos.\" };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 1500,
        "wires": [
            [
                "14532f7c737dafcf"
            ]
        ]
    },
    {
        "id": "5c81477eabc10c1c",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Init And F5: Video Stream",
        "links": [
            "c1d45c05dcc2f331"
        ],
        "x": 3055,
        "y": 1400,
        "wires": [
            [
                "40afbc6ab376fe63"
            ]
        ]
    },
    {
        "id": "df10633359171271",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Available Zip Generation",
        "func": "flow.set('makingZip', true);\nvar returnOk = null;\nvar returnBad = null;\n\nif (msg.payload.code == 0) {\n    returnOk = { payload: msg.payload, url: \"/files/Datos_Fotos.zip\", notification_to_user: \"Iniciando descarga.\" };\n} else {\n    returnBad = { payload: \"Error al descargar las imágenes.\" };\n}\n\nreturn [ returnBad, returnOk ];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 1560,
        "wires": [
            [
                "14532f7c737dafcf"
            ],
            [
                "939d34b570b6c9ee"
            ]
        ]
    },
    {
        "id": "939d34b570b6c9ee",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "Start Download",
        "func": "msg.payload = '<!DOCTYPE html><html><head><title>Redirect url to node-red forum</title></head><body>' + msg.notification_to_user + '<script>var url= \"' + msg.url + '\"; window.location = url; </script></body></html>';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 1600,
        "wires": [
            [
                "4b9fd0ce9af12507"
            ]
        ]
    },
    {
        "id": "4b9fd0ce9af12507",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "position": "top right",
        "displayTime": "1",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "topic": "",
        "name": "",
        "x": 1270,
        "y": 1600,
        "wires": []
    },
    {
        "id": "14287ac166a88472",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 500,
        "y": 1320,
        "wires": [
            [
                "da099d713da4bb10"
            ]
        ]
    },
    {
        "id": "fc603d7ddc8f5224",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "153fc0026305c5a8",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 500,
        "y": 1380,
        "wires": [
            [
                "0ff5e6377e477a97"
            ]
        ]
    },
    {
        "id": "3c71823641439b97",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "command": "python3 /home/pi//simfs/Python_Scripts/getTime.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "10",
        "winHide": false,
        "oldrc": false,
        "name": "Get Time",
        "x": 2240,
        "y": 660,
        "wires": [
            [
                "a2f33f0decdeeb7e"
            ],
            [],
            [
                "f8dab95a90ac6799"
            ]
        ]
    },
    {
        "id": "c6a9736beb8ca4a1",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "name": "Flow Variables",
        "func": "//Get RTC Time\nvar timeRTC = flow.get('timeRTC') || 0;\n\n// Video Stream and Make Zip\nflow.set('pyCamera', true);\nflow.set('makingZip', true);\n\n// Error RTC\nflow.set('handleRTCError', true);\n\n// Set RTC Calendar Days\nflow.set('lum_from_date', timeRTC.split(\"_\")[0]);\nflow.set('lum_to_date', timeRTC.split(\"_\")[0]);\n\nflow.set('tyh_from_date', timeRTC.split(\"_\")[0]);\nflow.set('tyh_to_date', timeRTC.split(\"_\")[0]);\n\nflow.set('png_from_date', timeRTC.split(\"_\")[0]);\nflow.set('png_to_date', timeRTC.split(\"_\")[0]);\n\nflow.set(\"presenceDate\", timeRTC.split(\"_\")[0]);\n\n// Calendar Dates\nflow.set('lum_valid_date', true);\nflow.set('tyh_valid_date', true);\nflow.set('png_valid_date', true);\n\n// Update Data \nflow.set('interval_photo', 5 * 60 * 1000);    //In ms\nflow.set('interval_tyh', 5 * 60 * 1000);      //In ms\nflow.set('interval_lum', 5 * 60 * 1000);      //In ms\nflow.set('photoNight', true);",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2420,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "621f31c2387df55f",
        "type": "trigger",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-1",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 2040,
        "y": 660,
        "wires": [
            [
                "3c71823641439b97",
                "a2ec51133add780f"
            ]
        ]
    },
    {
        "id": "a2f33f0decdeeb7e",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "name": "Set RTC Time",
        "func": "//Set RTC Time\nvar timeRTC = msg.payload.slice(0, -1);\nflow.set('timeRTC', timeRTC)\n\nlet photo_passed = { payload: timeHasPassed('lastFotoTaken', 'interval_photo') };\nlet tyh_passed = { payload: timeHasPassed('lastTyHTaken', 'interval_tyh') };\nlet lum_passed = { payload: timeHasPassed('lastLumTaken', 'interval_lum') };\n\nreturn [photo_passed, tyh_passed, lum_passed];\n\nfunction timeHasPassed(data, interval) {\n    var lastDataTaken = new Date(flow.get(data));\n\n    var timeRTC = flow.get('timeRTC');\n    timeRTC = timeRTC.split('_')[0] + 'T' + timeRTC.split('_')[1];\n    var timeRTCDate = new Date(timeRTC);\n\n    var difference = timeRTCDate.getTime() - lastDataTaken.getTime();\n\n    return difference >= flow.get(interval);\n}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2420,
        "y": 640,
        "wires": [
            [
                "ad50af1c77ca6229"
            ],
            [
                "c60e2529787e2803"
            ],
            [
                "2a321ba98578a3b7"
            ]
        ]
    },
    {
        "id": "02bfb4fbc2df5ea5",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2040,
        "y": 580,
        "wires": [
            [
                "a2ec51133add780f"
            ]
        ]
    },
    {
        "id": "4956872f8e5b87ce",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "command": "cd /home/pi/simfs/Python_Scripts/ && python3 DHT_22.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "100",
        "winHide": false,
        "oldrc": false,
        "name": "Update Data DHT_22",
        "x": 3140,
        "y": 540,
        "wires": [
            [
                "463c7e1c7cc8791d"
            ],
            [],
            []
        ]
    },
    {
        "id": "d1fb36ac9e21e0c6",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "command": "cd /home/pi/simfs/Python_Scripts/ && python3 BH1750.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "10",
        "winHide": false,
        "oldrc": false,
        "name": "Update Data BH1750",
        "x": 3140,
        "y": 640,
        "wires": [
            [
                "4de2905cb6f4fd89"
            ],
            [],
            []
        ]
    },
    {
        "id": "c60e2529787e2803",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Last TyH Time",
        "func": "if (msg.payload == true) {\n    var currentTime = flow.get('timeRTC') || 0;\n    currentTime = currentTime.split('_')[0] + 'T' + currentTime.split('_')[1];\n    flow.set('lastTyHTaken', currentTime);\n    return msg;    \n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2910,
        "y": 540,
        "wires": [
            [
                "4956872f8e5b87ce",
                "906710fb8b9a7298"
            ]
        ]
    },
    {
        "id": "2a321ba98578a3b7",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Last Lum Time",
        "func": "if (msg.payload == true) {\n    var currentTime = flow.get('timeRTC') || 0;\n    currentTime = currentTime.split('_')[0] + 'T' + currentTime.split('_')[1];\n    flow.set('lastLumTaken', currentTime);\n    return msg;    \n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2910,
        "y": 640,
        "wires": [
            [
                "d1fb36ac9e21e0c6",
                "42db76d7b88b039e"
            ]
        ]
    },
    {
        "id": "ad2daa0daf214307",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Photo Interval",
        "func": "var toReturn = { payload: flow.get('interval_photo') / (60 * 1000) };\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2800,
        "y": 1720,
        "wires": [
            [
                "1a5b94b69b728773"
            ]
        ]
    },
    {
        "id": "714fc8ea8a3eadc5",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "",
        "pauseType": "delay",
        "timeout": "1500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2520,
        "y": 1880,
        "wires": [
            [
                "ad2daa0daf214307",
                "7ec8debd1be24785",
                "7d4232130a08490a",
                "a275167bbe0d1ca0"
            ]
        ]
    },
    {
        "id": "7ec8debd1be24785",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Photo Night",
        "func": "var toReturn = { payload: flow.get('photoNight') };\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2790,
        "y": 1820,
        "wires": [
            [
                "ca662e9811d45aba"
            ]
        ]
    },
    {
        "id": "7d4232130a08490a",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "TyH Interval",
        "func": "var toReturn = { payload: flow.get('interval_tyh') / (60 * 1000) };\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2790,
        "y": 1960,
        "wires": [
            [
                "1332655bda5e8126"
            ]
        ]
    },
    {
        "id": "a275167bbe0d1ca0",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Lum Interval",
        "func": "var toReturn = { payload: flow.get('interval_lum') / (60 * 1000) };\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2790,
        "y": 2060,
        "wires": [
            [
                "48d8edec9aedd8f9"
            ]
        ]
    },
    {
        "id": "d0eece487dd898ae",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Init And F5: Configuration",
        "links": [
            "c1d45c05dcc2f331"
        ],
        "x": 2385,
        "y": 1880,
        "wires": [
            [
                "714fc8ea8a3eadc5"
            ]
        ]
    },
    {
        "id": "ca662e9811d45aba",
        "type": "ui_switch",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "",
        "label": "Usar filtro nocturno",
        "tooltip": "",
        "group": "6b5e5887ee54b112",
        "order": 7,
        "width": 6,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 2810,
        "y": 1860,
        "wires": [
            [
                "6aacb923b80940e3"
            ]
        ]
    },
    {
        "id": "1a5b94b69b728773",
        "type": "ui_numeric",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Photo Update",
        "label": "Tiempo en minutos",
        "tooltip": "",
        "group": "6b5e5887ee54b112",
        "order": 3,
        "width": 6,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": "5",
        "max": "60",
        "step": "1",
        "className": "",
        "x": 2800,
        "y": 1760,
        "wires": [
            [
                "424e283f6a8b7971"
            ]
        ]
    },
    {
        "id": "1332655bda5e8126",
        "type": "ui_numeric",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "TyH Update",
        "label": "Tiempo en minutos",
        "tooltip": "",
        "group": "74524b4a677dedb8",
        "order": 3,
        "width": 6,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": "5",
        "max": "60",
        "step": "1",
        "className": "",
        "x": 2790,
        "y": 1920,
        "wires": [
            [
                "3f8c9ee0edfd1aed"
            ]
        ]
    },
    {
        "id": "48d8edec9aedd8f9",
        "type": "ui_numeric",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Lum Update",
        "label": "Tiempo en minutos",
        "tooltip": "",
        "group": "b4be47d1fa09bf5e",
        "order": 3,
        "width": 6,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": "5",
        "max": "60",
        "step": "1",
        "className": "",
        "x": 2790,
        "y": 2020,
        "wires": [
            [
                "fdbfe6346fc78968"
            ]
        ]
    },
    {
        "id": "424e283f6a8b7971",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Set Photo Interval",
        "func": "var time_in_ms = msg.payload*1000*60;\nflow.set('interval_photo', time_in_ms);\n\nvar text = \"Intervalo de tiempo entre fotos. Tiempo mínimo configurable: 5 minutos. TIempo máximo configurable: 60 minutos.\"\nreturn { payload: text };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3090,
        "y": 1760,
        "wires": [
            [
                "1ebf9405058aacec"
            ]
        ]
    },
    {
        "id": "6aacb923b80940e3",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Update Photo Night",
        "func": "// Update Data \nflow.set('photoNight', msg.payload);\n\n//var time = flow.get('interval_photo'); / (60 * 1000);\n//var text = \"Prendido: Se saca una foto cada \" + String(time) + \" verificando el nivel de luminosidad y se emplea un filtro apropiado. Apagado: Se saca una foto cada \" + String(time) + \" minutos sin filtro.\";\nvar text = \"Prendido: Al momento de sacar una foto, si hay un bajo nivel de luminosidad se emplea un filtro apropiado. Apagado: Al momento de sacar una foto no se emplea ningún tipo de filtro.\";\nreturn { payload: text };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3090,
        "y": 1860,
        "wires": [
            [
                "5993b0fd2a06a714"
            ]
        ]
    },
    {
        "id": "3f8c9ee0edfd1aed",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Set TyH Interval",
        "func": "var time_in_ms = msg.payload*1000*60;\nflow.set('interval_tyh', time_in_ms);\n\nvar text = \"Intervalo de tiempo entre mediciones de Tiempo y entre mediciones de Humedad. Tiempo mínimo configurable: 5 minutos. TIempo máximo configurable: 60 minutos.\"\nreturn { payload: text };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3100,
        "y": 1920,
        "wires": [
            [
                "d1dfd51ff7688da8"
            ]
        ]
    },
    {
        "id": "fdbfe6346fc78968",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "name": "Set Lum Interval",
        "func": "var time_in_ms = msg.payload*1000*60;\nflow.set('interval_lum', time_in_ms);\n\nvar text = \"Intervalo de tiempo entre mediciones de Luminosidad. Tiempo mínimo configurable: 5 minutos. TIempo máximo configurable: 60 minutos.\"\nreturn { payload: text };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3100,
        "y": 2020,
        "wires": [
            [
                "b722117212951963"
            ]
        ]
    },
    {
        "id": "1ebf9405058aacec",
        "type": "ui_text",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "group": "6b5e5887ee54b112",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Photo Text",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 3110,
        "y": 1720,
        "wires": []
    },
    {
        "id": "5993b0fd2a06a714",
        "type": "ui_text",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "group": "6b5e5887ee54b112",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "Night Text",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 3120,
        "y": 1820,
        "wires": []
    },
    {
        "id": "d1dfd51ff7688da8",
        "type": "ui_text",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "group": "74524b4a677dedb8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "TyH Text",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 3120,
        "y": 1960,
        "wires": []
    },
    {
        "id": "b722117212951963",
        "type": "ui_text",
        "z": "4bd3f7a138ab9bf8",
        "g": "3a9c760f97d8aca9",
        "group": "b4be47d1fa09bf5e",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Lum Text",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 3120,
        "y": 2060,
        "wires": []
    },
    {
        "id": "f1be12d6cd818d02",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set Lum Date From",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('lum_from_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 1980,
        "wires": [
            [
                "2ccd72f009dcdb1a"
            ]
        ]
    },
    {
        "id": "a938137a58472e46",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set Lum Date To",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('lum_to_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 2020,
        "wires": [
            [
                "2ccd72f009dcdb1a"
            ]
        ]
    },
    {
        "id": "b767dbd5a1685857",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set PNG Date From",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('png_from_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 1780,
        "wires": [
            [
                "430e260f73a371bb"
            ]
        ]
    },
    {
        "id": "0731df5759089676",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set PNG Date To",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('png_to_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 1820,
        "wires": [
            [
                "430e260f73a371bb"
            ]
        ]
    },
    {
        "id": "30e079efb57dec7f",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set TyH Date From",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('tyh_from_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 1880,
        "wires": [
            [
                "eb0daa897167e3eb"
            ]
        ]
    },
    {
        "id": "fb2dd40f5d756dbd",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Set TyH Date To",
        "func": "var aux = new Date(msg.payload);\nvar toSet = aux.toISOString().split('T')[0];\n\nflow.set('tyh_to_date', toSet);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 1920,
        "wires": [
            [
                "eb0daa897167e3eb"
            ]
        ]
    },
    {
        "id": "610da4e4e817e3bb",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "5359da4031524f2e",
        "name": "Flow Date Variables",
        "info": "Setean todas las variables de flow de las fechas",
        "x": 900,
        "y": 1740,
        "wires": []
    },
    {
        "id": "7f763d8a1cf9b132",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "Lum desde",
        "label": "Mostrar datos desde:",
        "group": "f44b173abdb7e275",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 640,
        "y": 1980,
        "wires": [
            [
                "f1be12d6cd818d02"
            ]
        ]
    },
    {
        "id": "ca6d33cc46bb1d90",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "Lum hasta",
        "label": "Mostrar datos hasta:",
        "group": "f44b173abdb7e275",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 640,
        "y": 2020,
        "wires": [
            [
                "a938137a58472e46"
            ]
        ]
    },
    {
        "id": "a5ea1275479e4107",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "PNG desde",
        "label": "Mostrar datos desde:",
        "group": "ed493faf50b74f04",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 640,
        "y": 1780,
        "wires": [
            [
                "b767dbd5a1685857"
            ]
        ]
    },
    {
        "id": "e43b37cc9f8b7107",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "PNG hasta",
        "label": "Mostrar datos hasta:",
        "group": "ed493faf50b74f04",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 640,
        "y": 1820,
        "wires": [
            [
                "0731df5759089676"
            ]
        ]
    },
    {
        "id": "055bef59dda0482c",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "TyH desde",
        "label": "Mostrar datos desde:",
        "group": "4ad91a62eed23859",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 640,
        "y": 1880,
        "wires": [
            [
                "30e079efb57dec7f"
            ]
        ]
    },
    {
        "id": "209647a33910046e",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0a6f3b8e1ebb393c",
        "name": "TyH hasta",
        "label": "Mostrar datos hasta:",
        "group": "4ad91a62eed23859",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 630,
        "y": 1920,
        "wires": [
            [
                "fb2dd40f5d756dbd"
            ]
        ]
    },
    {
        "id": "941f5e0a89a8d99b",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "462404854100f1af",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1440,
        "y": 1940,
        "wires": []
    },
    {
        "id": "0d76ee4ca04c3dc8",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "462404854100f1af",
        "name": "Date Fail Notification",
        "info": "Si las fechas no son correctas se le notifica al usuario",
        "x": 1440,
        "y": 1860,
        "wires": []
    },
    {
        "id": "f616f00dc5c6adc5",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "462404854100f1af",
        "name": "Check Notification Fail",
        "func": "if ( msg.payload.error ) {\n    if (msg.payload.var_update == \"Lum_fail\") {\n        msg.payload = \"Las fechas seleccionadas para la Luminosidad son invalidas.\";\n    } else if (msg.payload.var_update == \"Tyh_fail\") {\n        msg.payload = \"Las fechas seleccionadas para la Temperatura y Humedad son invalidas.\";\n    } else if (msg.payload.var_update == \"Png_fail\") {\n        msg.payload = \"Las fechas seleccionadas para las Imágenes son invalidas.\";\n    }\n    \n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1450,
        "y": 1900,
        "wires": [
            [
                "941f5e0a89a8d99b"
            ]
        ]
    },
    {
        "id": "2ccd72f009dcdb1a",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7347cb65ebc131db",
        "name": "Check Lum Date",
        "func": "var lum_from_date = flow.get('lum_from_date') || 0;\nvar lum_to_date = flow.get('lum_to_date') || 0;\n\nvar year_from = parseInt(lum_from_date.substring(0, 4));\nvar month_from = parseInt(lum_from_date.substring(5, 7));\nvar day_from = parseInt(lum_from_date.substring(8, 10));\n\nvar year_to = parseInt(lum_to_date.substring(0, 4));\nvar month_to = parseInt(lum_to_date.substring(5, 7));\nvar day_to = parseInt(lum_to_date.substring(8, 10));\n\nvar year = (year_from < year_to);\nvar same_year = (year_from == year_to);\n\nvar month = (month_from < month_to);\nvar same_month = (month_from == month_to);\n\nvar day = (day_from <= day_to);\n\nif (year || (same_year && month) || (same_year && same_month && day)) {\n    msg.payload = { var_update: \"Lum\", value: msg.payload, error: false };\n    flow.set('lum_valid_date', true);\n} else {\n    msg.payload = { var_update: \"Lum_fail\", error: true };\n    flow.set('lum_valid_date', false);\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1180,
        "y": 2000,
        "wires": [
            [
                "f616f00dc5c6adc5",
                "4789b2a4961fd39c"
            ]
        ]
    },
    {
        "id": "430e260f73a371bb",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7347cb65ebc131db",
        "name": "Check PNG Date",
        "func": "var png_from_date = flow.get('png_from_date') || 0;\nvar png_to_date = flow.get('png_to_date') || 0;\n\nvar year_from = parseInt(png_from_date.substring(0, 4));\nvar month_from = parseInt(png_from_date.substring(5, 7));\nvar day_from = parseInt(png_from_date.substring(8, 10));\n\nvar year_to = parseInt(png_to_date.substring(0, 4));\nvar month_to = parseInt(png_to_date.substring(5, 7));\nvar day_to = parseInt(png_to_date.substring(8, 10));\n\nvar year = (year_from < year_to);\nvar same_year = (year_from == year_to);\n\nvar month = (month_from < month_to);\nvar same_month = (month_from == month_to);\n\nvar day = (day_from <= day_to);\n\nif (year || (same_year && month) || (same_year && same_month && day)) {\n    msg.payload = { var_update: \"Png\", value: msg.payload, error: false };\n    flow.set('png_valid_date', true);\n} else {\n    msg.payload = { var_update: \"Png_fail\", error: true };\n    flow.set('png_valid_date', false);\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1180,
        "y": 1800,
        "wires": [
            [
                "f616f00dc5c6adc5",
                "659dd377658b5f9b"
            ]
        ]
    },
    {
        "id": "eb0daa897167e3eb",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7347cb65ebc131db",
        "name": "Check TyH Date",
        "func": "var tyh_from_date = flow.get('tyh_from_date') || 0;\nvar tyh_to_date = flow.get('tyh_to_date') || 0;\n\nvar year_from = parseInt(tyh_from_date.substring(0, 4));\nvar month_from = parseInt(tyh_from_date.substring(5, 7));\nvar day_from = parseInt(tyh_from_date.substring(8, 10));\n\nvar year_to = parseInt(tyh_to_date.substring(0, 4));\nvar month_to = parseInt(tyh_to_date.substring(5, 7));\nvar day_to = parseInt(tyh_to_date.substring(8, 10));\n\nvar year = (year_from < year_to);\nvar same_year = (year_from == year_to);\n\nvar month = (month_from < month_to);\nvar same_month = (month_from == month_to);\n\nvar day = (day_from <= day_to);\n\nif (year || (same_year && month) || (same_year && same_month && day)) {\n    msg.payload = { var_update: \"Tyh\", value: msg.payload, error: false };\n    flow.set('tyh_valid_date', true);\n} else {\n    msg.payload = { var_update: \"Tyh_fail\", error: true };\n    flow.set('tyh_valid_date', false);    \n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1190,
        "y": 1900,
        "wires": [
            [
                "f616f00dc5c6adc5",
                "487302c17ac70c69"
            ]
        ]
    },
    {
        "id": "ff4af9e483865444",
        "type": "comment",
        "z": "4bd3f7a138ab9bf8",
        "g": "7347cb65ebc131db",
        "name": "Date Check",
        "info": "Chequea que las fechas estén correctas",
        "x": 1180,
        "y": 1760,
        "wires": []
    },
    {
        "id": "4789b2a4961fd39c",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "Reload Data Lum: Calendar Update",
        "mode": "link",
        "links": [
            "1d5c105e7d84579f"
        ],
        "x": 1205,
        "y": 1960,
        "wires": []
    },
    {
        "id": "487302c17ac70c69",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "Reload Data TyH: Calendar Update",
        "mode": "link",
        "links": [
            "0c3d2b26b256d05e"
        ],
        "x": 1205,
        "y": 1860,
        "wires": []
    },
    {
        "id": "41303a729b281d8c",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "Set Date",
        "func": "var rtc = flow.get('timeRTC').split(\"_\")[0] + 'T' + flow.get('timeRTC').split(\"_\")[1] + '.000Z';\nvar date = new Date(rtc);\n\nreturn { payload: date.toISOString() };\n\n/*\nlet dateRTC = flow.get('timeRTC').split(\"_\")[0];\nlet year = parseInt(dateRTC.split(\"-\")[0]);\nlet month = parseInt(dateRTC.split(\"-\")[1]);\nlet day = parseInt(dateRTC.split(\"-\")[2]);\n\nvar date = new Date(year, month - 1, day);//.toISOString()\n\nreturn { payload: date };\n*/",
        "outputs": 1,
        "noerr": 0,
        "initialize": "var rtc = flow.get('timeRTC').split(\"_\")[0] + 'T' + flow.get('timeRTC').split(\"_\")[1] + '.000Z';\nvar date = new Date(rtc);\n\nreturn { payload: date.toISOString() };",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 1900,
        "wires": [
            [
                "7f763d8a1cf9b132",
                "ca6d33cc46bb1d90",
                "a5ea1275479e4107",
                "e43b37cc9f8b7107",
                "055bef59dda0482c",
                "209647a33910046e",
                "c43218c63003d980"
            ]
        ]
    },
    {
        "id": "009eb7a08b8f1d4f",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "Init: Date Manager",
        "links": [
            "c8caecc46da13eb1"
        ],
        "x": 435,
        "y": 1820,
        "wires": [
            [
                "63b8d6ff13f59204"
            ]
        ]
    },
    {
        "id": "63b8d6ff13f59204",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "38b2e4140c614a54",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 430,
        "y": 1860,
        "wires": [
            [
                "41303a729b281d8c"
            ]
        ]
    },
    {
        "id": "463c7e1c7cc8791d",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Reload Data TyH: Take Data Update",
        "mode": "link",
        "links": [
            "0c3d2b26b256d05e"
        ],
        "x": 3285,
        "y": 540,
        "wires": []
    },
    {
        "id": "4de2905cb6f4fd89",
        "type": "link out",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Reload Data Lum: Take Data Update",
        "mode": "link",
        "links": [
            "1d5c105e7d84579f"
        ],
        "x": 3285,
        "y": 640,
        "wires": []
    },
    {
        "id": "f0f7068830d8bb5a",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Read Time Lum",
        "filename": "/home/pi/LastData/time_lum.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2120,
        "y": 800,
        "wires": [
            [
                "ab19c6983b4d19d5"
            ]
        ]
    },
    {
        "id": "b6de08c6dbd52d64",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Read Time TyH",
        "filename": "/home/pi/LastData/time_tyh.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2120,
        "y": 840,
        "wires": [
            [
                "dadd83795049ff57"
            ]
        ]
    },
    {
        "id": "fe232b59628bb1e3",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Read Time Ph",
        "filename": "/home/pi/LastData/time_photo.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2120,
        "y": 880,
        "wires": [
            [
                "5799c7c643a4ddd7"
            ]
        ]
    },
    {
        "id": "ab19c6983b4d19d5",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Set Time Lum",
        "rules": [
            {
                "t": "set",
                "p": "lastLumTaken",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2340,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "dadd83795049ff57",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Set Time TyH",
        "rules": [
            {
                "t": "set",
                "p": "lastTyHTaken",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2340,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "5799c7c643a4ddd7",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Set Time Photo",
        "rules": [
            {
                "t": "set",
                "p": "lastFotoTaken",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2340,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "3a2542022481af0f",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "b04f466bf94de283",
        "name": "Init and F5: Read From File",
        "links": [
            "c1d45c05dcc2f331"
        ],
        "x": 1985,
        "y": 840,
        "wires": [
            [
                "f0f7068830d8bb5a",
                "b6de08c6dbd52d64",
                "fe232b59628bb1e3"
            ]
        ]
    },
    {
        "id": "561712e4b8e43c43",
        "type": "file",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Write Time Lum",
        "filename": "/home/pi/LastData/time_lum.json",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 3300,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "220233ad3436d22a",
        "type": "file",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Write Time TyH",
        "filename": "/home/pi/LastData/time_tyh.json",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 3300,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "af831710c2f29c8d",
        "type": "file",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Write Time Ph",
        "filename": "/home/pi/LastData/time_photo.json",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 3300,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "d6bf6c0d1939afe5",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Time Photo",
        "func": "return { payload: flow.get('lastFotoTaken') };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3120,
        "y": 400,
        "wires": [
            [
                "af831710c2f29c8d"
            ]
        ]
    },
    {
        "id": "906710fb8b9a7298",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Time TyH",
        "func": "return { payload: flow.get('lastTyHTaken') };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3120,
        "y": 500,
        "wires": [
            [
                "220233ad3436d22a"
            ]
        ]
    },
    {
        "id": "42db76d7b88b039e",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "name": "Set Time Lum",
        "func": "return { payload: flow.get('lastLumTaken') };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3120,
        "y": 600,
        "wires": [
            [
                "561712e4b8e43c43"
            ]
        ]
    },
    {
        "id": "a8865b9e2ca35101",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "group": "e09affd1d78f162d",
        "order": 6,
        "width": 4,
        "height": 2,
        "passthru": true,
        "label": "Terminar transmisión",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "SIGTERM",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 3020,
        "y": 1500,
        "wires": [
            [
                "b0324bc31c51dfa5"
            ]
        ]
    },
    {
        "id": "b0324bc31c51dfa5",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Check PyCamera State",
        "func": "if (!(flow.get('pyCamera') || 0)) {\n    flow.set('pyCamera', true);\n    return { kill: \"SIGTERM\"};\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2970,
        "y": 1460,
        "wires": [
            [
                "eec915a79c477847"
            ]
        ]
    },
    {
        "id": "8d39a11b2b0c66a2",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Read Presence File",
        "filename": "/home/pi/LastData/presence.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 990,
        "y": 2160,
        "wires": [
            [
                "95a10332743c4a8e"
            ]
        ]
    },
    {
        "id": "95a10332743c4a8e",
        "type": "json",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1150,
        "y": 2160,
        "wires": [
            [
                "428c7be7b578af87",
                "6f3ae68f41a73c5f"
            ]
        ]
    },
    {
        "id": "428c7be7b578af87",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "group": "5f21bab708c4b0d2",
        "name": "Chart",
        "order": 4,
        "width": 0,
        "height": 0,
        "format": "<!DOCTYPE html>\n<html>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js\"></script>\n\n<div id=\"divCanvas\">\n  <canvas id=\"myChart\" style=\"width:100%;max-width:600px\"></canvas>\n\n  <script>\n\t(function(scope) {\n\t\tscope.$watch('msg', function(msg) {\n\t\t\t\n\t\t\tlet divCanvas = document.getElementById(\"divCanvas\");\n\t\t\tlet canvas_del = document.getElementById(\"myChart\");\n\t\t\tdivCanvas.removeChild(canvas_del);\n\t\t\t\n\t\t\tvar canvas_new = document.createElement('canvas');\n\t\t\tcanvas_new.id = \"myChart\";\n\t\t\tcanvas_new.style = \"width:100%;height:400px\";//\";max-width:600px\";\n\t\t\tdivCanvas.appendChild(canvas_new);\n\n\t\t\tvar data = msg.payload;\n\t\t\tvar xValues = [];\n\t\t\tvar yValues = [];\n\t\t\tvar yValues_n = [];\n\t\t\t\n\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\tif (msg.calendar == data[i].day ) {\n\t\t\t\t\txValues.push(data[i].hour);\n\t\t\t\t\tyValues.push(data[i].state);\n\t\t\t\t\tyValues_n.push(!data[i].state ? 1 : 0 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnew Chart('myChart', {\n\t\t\t\ttype: \"line\",\n\t\t\t\tdata: {\n\t\t\t\t\tlabels: xValues,\n\t\t\t\t\tdatasets: [{\n\t\t\t\t\t\tlabel: \"Fuera del Nido\",\n\t\t\t\t\t\tfill: true,\n\t\t\t\t\t\tlineTension: 0,\n\t\t\t\t\t\tpointRadius: 0,\n\t\t\t\t\t\tbackgroundColor: \"rgba(255,0,0,0.5)\",\n\t\t\t\t\t\tborderColor: \"rgba(31,119,180,0.0)\",\n\t\t\t\t\t\tdata: yValues,\n\t\t\t\t\t\tsteppedLine: true\n\t\t\t\t\t},{\n\t\t\t\t\t\tlabel: \"Dentro del Nido\",\n\t\t\t\t\t\tfill: true,\n\t\t\t\t\t\tlineTension: 0,\n\t\t\t\t\t\tpointRadius: 0,\n\t\t\t\t\t\tbackgroundColor: \"rgba(0,255,0,0.5)\",\n\t\t\t\t\t\tborderColor: \"rgba(31,119,180,0.0)\",\n\t\t\t\t\t\tdata: yValues_n,\n\t\t\t\t\t\tsteppedLine: true\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\toptions: {\n\t\t\t\t\tlegend: { display: true },\n\t\t\t\t\tscales: {\n\t\t\t\t\t\tyAxes: [{\n\t\t\t\t\t\t\tticks: {display: false},\n\t\t\t\t\t\t\tgridLines: {color: \"rgba(0, 0, 0, 0)\"}  \n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\tx: {\n\t\t\t\t\t\ttype: 'time'\n\t\t\t\t\t},\n\t\t\t\t\ttooltips: {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tintersect: false,\n\t\t\t\t\t\tcustom: function(tooltipModel) {\n\t\t\t\t\t\t\tif (tooltipModel.title == \"\") {\n\t\t\t\t\t\t\t\ttooltipModel.opacity = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcallbacks: {\n\t\t\t\t\t\t\ttitle: function (tooltipItem, data) {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet selected = tooltipItem[0].index;\n\t\t\t\t\t\t\t\tlet total = data.labels.length;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar next = total - 1;\n\t\t\t\t\t\t\t\tvar previous = 0;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar actual_value = data.datasets[0].data[selected]; \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tfor (var i = selected; i < total; i++) {\n\t\t\t\t\t\t\t\t\tvar next_value = data.datasets[0].data[i];\n\t\t\t\t\t\t\t\t\tif (actual_value != next_value) {\n\t\t\t\t\t\t\t\t\t\tif (next_value != data.datasets[0].data[i-1]) {\n\t\t\t\t\t\t\t\t\t\t\tnext = i;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tfor (var i = selected; i >= 0; i--) { \n\t\t\t\t\t\t\t\t\tvar prev_value = data.datasets[0].data[i];\n\t\t\t\t\t\t\t\t\tif (actual_value != prev_value) {\n\t\t\t\t\t\t\t\t\t\tif (prev_value != data.datasets[0].data[i+1]) {\n\t\t\t\t\t\t\t\t\t\t\tprevious = i + 1;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet d1 = new Date();\n\t\t\t\t\t\t\t\td1.setHours(data.labels[previous].split(\":\")[0]);\n\t\t\t\t\t\t\t\td1.setMinutes(data.labels[previous].split(\":\")[1]);\n\t\t\t\t\t\t\t\td1.setSeconds(data.labels[previous].split(\":\")[2]);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet d2 = new Date();\n\t\t\t\t\t\t\t\td2.setHours(data.labels[next].split(\":\")[0]);\n\t\t\t\t\t\t\t\td2.setMinutes(data.labels[next].split(\":\")[1]);\n\t\t\t\t\t\t\t\td2.setSeconds(data.labels[next].split(\":\")[2]);\n\n\t\t\t\t\t\t\t\tlet diff = new Date(d2 - d1).toISOString().slice(11, 19);\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif ( (tooltipItem[0].yLabel == 1) && (selected != (total - 1)) ){\n\t\t\t\t\t\t\t\t\treturn \"Intervalo de tiempo:\" + '\\n' + diff;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlabel: function(tooltipItem, data) {\n\t\t\t\t\t\t\t\tif (tooltipItem.yLabel == 1) {\n\t\t\t\t\t\t\t\t\treturn \"Dentro del Nido.\";\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn \"Fuera del Nido.\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfooter: function (tooltipItem, data) {\n\t\t\t\t\t\t\t\tif (tooltipItem[0].yLabel == 1) { \n\t\t\t\t\t\t\t\t\t//return \"...\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\n\t\t\t});\t\t\n\t\t});\t\t\t\t\n\t})(scope);\n  </script>\n\n</div>\n\n</html>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1310,
        "y": 2160,
        "wires": [
            []
        ]
    },
    {
        "id": "c43218c63003d980",
        "type": "ui_date_picker",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Presence Date",
        "label": "",
        "group": "5f21bab708c4b0d2",
        "order": 1,
        "width": 6,
        "height": 1,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 660,
        "y": 2160,
        "wires": [
            [
                "63c90edf1fc0b5c5"
            ]
        ]
    },
    {
        "id": "63c90edf1fc0b5c5",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Date",
        "func": "var toReturn = \"\";\n\nif (typeof msg.payload === 'number') {\n    var date = new Date(msg.payload);\n    toReturn = date.toISOString().split('T')[0]\n    flow.set(\"presenceDate\", toReturn);\n} else if (typeof msg.payload === 'string') {\n    toReturn = flow.get(\"presenceDate\");\n}\n\nreturn { calendar: toReturn };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 2160,
        "wires": [
            [
                "8d39a11b2b0c66a2"
            ]
        ]
    },
    {
        "id": "21bf379491b3b12b",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "90ef18f8b38770c1",
        "name": "Save State",
        "func": "if (msg != null) {\n    let timeRTC = flow.get('timeRTC') || 0;\n    let day = timeRTC.split('_')[0];\n    let hour = timeRTC.split('_')[1];\n\n    var array = [];\n    array = msg.payload;\n    array.push({ day: day, hour: hour, state: msg.state });\n    msg.payload = array;\n    \n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2950,
        "y": 940,
        "wires": [
            [
                "3def40830c4ec2ba"
            ]
        ]
    },
    {
        "id": "7c7cf62d4bba59de",
        "type": "file in",
        "z": "4bd3f7a138ab9bf8",
        "g": "90ef18f8b38770c1",
        "name": "Read Presence File",
        "filename": "/home/pi/LastData/presence.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 2930,
        "y": 900,
        "wires": [
            [
                "a2ed3487bb11f95f"
            ]
        ]
    },
    {
        "id": "a2ed3487bb11f95f",
        "type": "json",
        "z": "4bd3f7a138ab9bf8",
        "g": "90ef18f8b38770c1",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2810,
        "y": 940,
        "wires": [
            [
                "21bf379491b3b12b"
            ]
        ]
    },
    {
        "id": "3def40830c4ec2ba",
        "type": "file",
        "z": "4bd3f7a138ab9bf8",
        "g": "90ef18f8b38770c1",
        "name": "Write Presence File",
        "filename": "/home/pi/LastData/presence.json",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 2930,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "c1a2cc44f4c758e7",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "90ef18f8b38770c1",
        "name": "State",
        "func": "if (msg.payload == \"¡Acába de llegar el pájaro!\") {\n    return { state: 1 };\n} else if (msg.payload == \"El pájaro se fue a pasear :(\") {\n    return { state: 0 };\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2770,
        "y": 900,
        "wires": [
            [
                "7c7cf62d4bba59de"
            ]
        ]
    },
    {
        "id": "4fedabf67f0c7fe4",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Reload",
        "group": "5f21bab708c4b0d2",
        "order": 2,
        "width": 1,
        "height": 1,
        "passthru": true,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-repeat fa-lg",
        "payload": "Reload",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 820,
        "y": 2200,
        "wires": [
            [
                "63c90edf1fc0b5c5"
            ]
        ]
    },
    {
        "id": "e49f02fd88eb7bfd",
        "type": "watch",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Presence",
        "files": "/home/pi/LastData/presence.json",
        "recursive": "",
        "x": 640,
        "y": 2200,
        "wires": [
            [
                "4fedabf67f0c7fe4"
            ]
        ]
    },
    {
        "id": "bfa63315e2663064",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1270,
        "y": 2200,
        "wires": []
    },
    {
        "id": "6f3ae68f41a73c5f",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "0ee206c8ef765709",
        "name": "Set Notification",
        "func": "var data = msg.payload;\nvar xValues = [];\n\nfor (var i = 0; i < data.length; i++) {\n    if (msg.calendar == data[i].day) {\n        xValues.push(data[i].hour);\n    }\n}\t\t\t\n\nif (context.get(\"firstTime\") == false) {\n    if (xValues.length == 0) {\n        var calendar = msg.calendar.split('-')[2] + '/' + msg.calendar.split('-')[1] + '/' + msg.calendar.split('-')[0];\n        return { payload: \"No hay datos del día \" + calendar };\n    }\n} else {\n    context.set(\"firstTime\", false);\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 2200,
        "wires": [
            [
                "bfa63315e2663064"
            ]
        ]
    },
    {
        "id": "b13896a2f12a15f2",
        "type": "ui_template",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "group": "4f44b35e1169a30d",
        "name": "Draw Map",
        "order": 1,
        "width": 25,
        "height": 19,
        "format": "<div>\n    <!-- <img src={{msg.payload}}> -->\n    <canvas id=\"myCanvasMap\" width=\"1320\" height=\"1000\">\n        Your browser does not support the HTML5 canvas tag.\n    </canvas>\n\n\n    <script>\n        (function(scope) {\n    scope.$watch('msg', function(msg) {\n    var canvas = document.getElementById(\"myCanvasMap\");\n    var ctx = canvas.getContext(\"2d\");\n    const img = new Image();\n    img.src = msg.payload;\n    img.onload = () => {\n        ctx.drawImage(img, 0, 0);\n        ctx.lineWidth = 3;\n        let x0 = msg.batch[0][1]+7\n        let y0 = msg.batch[0][2]+8\n        ctx.moveTo(x0,y0);\n         for (let i = 2; i < msg.batch.length; i++) {\n            ctx.moveTo(msg.batch[i-1].parameters[1]+7,msg.batch[i-1].parameters[2]+8);\n            let x = msg.batch[i].parameters[1]+7;\n            let y = msg.batch[i].parameters[2]+8;\n            ctx.lineTo(x, y);\n\n        } \n            ctx.strokeStyle = \"#FF0000\";\n        ctx.stroke();\n    };\n\n    });\n})(scope);\n    </script>\n\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1830,
        "y": 2300,
        "wires": [
            []
        ]
    },
    {
        "id": "564585eb.ab740c",
        "type": "jimp-image",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "",
        "data": "/home/pi/simfs/NidoImagesFrontEnd/map.png",
        "dataType": "str",
        "ret": "b64",
        "parameter1": "batch",
        "parameter1Type": "msg",
        "parameter2": "",
        "parameter2Type": "msg",
        "parameter3": "",
        "parameter3Type": "msg",
        "parameter4": "",
        "parameter4Type": "msg",
        "parameter5": "",
        "parameter5Type": "msg",
        "parameter6": "",
        "parameter6Type": "msg",
        "parameter7": "",
        "parameter7Type": "msg",
        "parameter8": "",
        "parameter8Type": "msg",
        "sendProperty": "payload",
        "parameterCount": 1,
        "jimpFunction": "batch",
        "selectedJimpFunction": {
            "name": "batch",
            "fn": "batch",
            "description": "apply one or more functions",
            "parameters": [
                {
                    "name": "options",
                    "type": "json",
                    "required": true,
                    "hint": "an object or an array of objects containing {\"name\" : \"function_name\", \"parameters\" : [x,y,z]}.  Refer to info on side panel}"
                }
            ]
        },
        "x": 1690,
        "y": 2300,
        "wires": [
            [
                "b13896a2f12a15f2"
            ]
        ]
    },
    {
        "id": "b868cd58.8d414",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "PhotoCombiner",
        "func": "\nvar pos = global.get(\"pos\");\nvar addHouse = global.get(\"addHouse\");\n//some common vars (these could be passed in from another node)\nvar position = msg.payload.position || {  x : 1000, y: 1000 }\nvar padding = msg.payload.padding || { x: 2, y: 2 };\nvar icon = msg.payload.parrilla; //get icon loaded by previous node\nvar icon2 = msg.payload.icon;\nvar house = msg.payload.house;\n\n//create the batch operations\nmsg.batch = [];\n\nif(icon && addHouse == false){\n    //op1 blt an icon onto image\n    var op1 = {\n        \"name\":\"blit\",\n        \"parameters\":[\n            icon,\n            position.x, //dst x\n            position.y, //dst y\n            0, //src x\n            0, //src y\n            50 , //src w\n            50   //src h\n        ]\n    }\n    msg.batch.push(op1);\n}\n\nvar len = pos.length;\n\nif (icon2) {\n    for (let index = 0; index < pos.length; index++) {\n    var op2 = {\n        \"name\": \"blit\",\n        \"parameters\": [\n            icon2,\n            pos[index].x+25, //dst x\n            pos[index].y+25, //dst y\n            0, //src x\n            0, //src y\n            15, //src w\n            15   //src h\n        ]\n    }\n    msg.batch.push(op2);\n}\nif(addHouse == false){\n    pos.push(position);\n}\n}\nif (house && addHouse){\n\n    var op2 = {\n        \"name\": \"blit\",\n        \"parameters\": [\n            house,\n           575, //dst x\n            400, //dst y\n            0, //src x\n            0, //src y\n            50, //src w\n            50   //src h\n        ]\n    }\n    msg.batch.push(op2);\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 2300,
        "wires": [
            [
                "564585eb.ab740c"
            ]
        ]
    },
    {
        "id": "37f3892b.89a456",
        "type": "jimp-image",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "Yellow Dot",
        "data": "/home/pi/simfs/NidoImagesFrontEnd/yellowDot.png",
        "dataType": "str",
        "ret": "img",
        "parameter1": "15",
        "parameter1Type": "num",
        "parameter2": "15",
        "parameter2Type": "num",
        "parameter3": "RESIZE_BILINEAR",
        "parameter3Type": "resizeMode",
        "parameter4": "",
        "parameter4Type": "",
        "parameter5": "",
        "parameter5Type": "",
        "parameter6": "",
        "parameter6Type": "",
        "parameter7": "",
        "parameter7Type": "",
        "parameter8": "",
        "parameter8Type": "",
        "sendProperty": "payload.icon",
        "parameterCount": 3,
        "jimpFunction": "resize",
        "selectedJimpFunction": {
            "name": "resize",
            "fn": "resize",
            "description": "resize the image. One of the w or h parameters can be set to automatic (\"Jimp.AUTO\" or -1).",
            "parameters": [
                {
                    "name": "w",
                    "type": "num|auto",
                    "required": true,
                    "hint": "the width to resize the image to (or \"Jimp.AUTO\" or -1)"
                },
                {
                    "name": "h",
                    "type": "num|auto",
                    "required": true,
                    "hint": "the height to resize the image to (or \"Jimp.AUTO\" or -1)"
                },
                {
                    "name": "mode",
                    "type": "resizeMode",
                    "required": false,
                    "hint": "a scaling method (e.g. Jimp.RESIZE_BEZIER)"
                }
            ]
        },
        "x": 1530,
        "y": 2260,
        "wires": [
            [
                "e986bd4ab3fef777"
            ]
        ],
        "icon": "font-awesome/fa-image"
    },
    {
        "id": "f6b8d38e3af54de5",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "TrajectoryGenerator",
        "func": "// create random position\nvar counter = global.get(\"trajectoryCounter\");\nvar rad = global.get(\"R\");\nvar steps = global.get(\"steps\");\nif(counter == 0){\n    counter = 1;\n}\nelse if (counter > steps){\n    counter = 1;\n\n    global.set(\"steps\", steps - 10)\n    if (rad == 50){\n        global.set(\"addHouse\",true);\n    }\n}\nglobal.set(\"R\", rad - 1) \nvar t = counter * Math.PI * 2 / steps;\n\nvar x = Math.floor(Math.cos(t)*rad+550 + Math.random() * 15)\nvar y = Math.floor(Math.sin(t) * rad + 400 + Math.random() * 15)\nglobal.set(\"trajectoryCounter\",counter+1);\n\nmsg.payload = { \"position\": { \"x\": x, \"y\": y }, \"padding\": { \"x\": 5, \"y\": 2 } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1820,
        "y": 2200,
        "wires": [
            [
                "37f3892b.89a456"
            ]
        ]
    },
    {
        "id": "362f7dc1cb0b61b5",
        "type": "trigger",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1580,
        "y": 2200,
        "wires": [
            [
                "f6b8d38e3af54de5"
            ]
        ]
    },
    {
        "id": "e986bd4ab3fef777",
        "type": "jimp-image",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "BirdIcon",
        "data": "/home/pi/simfs/NidoImagesFrontEnd/iconWoodpecker.png",
        "dataType": "str",
        "ret": "img",
        "parameter1": "",
        "parameter1Type": "auto",
        "parameter2": "50",
        "parameter2Type": "num",
        "parameter3": "RESIZE_BILINEAR",
        "parameter3Type": "resizeMode",
        "parameter4": "",
        "parameter4Type": "",
        "parameter5": "",
        "parameter5Type": "",
        "parameter6": "",
        "parameter6Type": "",
        "parameter7": "",
        "parameter7Type": "",
        "parameter8": "",
        "parameter8Type": "",
        "sendProperty": "payload.parrilla",
        "parameterCount": 3,
        "jimpFunction": "resize",
        "selectedJimpFunction": {
            "name": "resize",
            "fn": "resize",
            "description": "resize the image. One of the w or h parameters can be set to automatic (\"Jimp.AUTO\" or -1).",
            "parameters": [
                {
                    "name": "w",
                    "type": "num|auto",
                    "required": true,
                    "hint": "the width to resize the image to (or \"Jimp.AUTO\" or -1)"
                },
                {
                    "name": "h",
                    "type": "num|auto",
                    "required": true,
                    "hint": "the height to resize the image to (or \"Jimp.AUTO\" or -1)"
                },
                {
                    "name": "mode",
                    "type": "resizeMode",
                    "required": false,
                    "hint": "a scaling method (e.g. Jimp.RESIZE_BEZIER)"
                }
            ]
        },
        "x": 1680,
        "y": 2260,
        "wires": [
            [
                "61a3e16978134041"
            ]
        ],
        "icon": "font-awesome/fa-image"
    },
    {
        "id": "61a3e16978134041",
        "type": "jimp-image",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "House",
        "data": "/home/pi/simfs/NidoImagesFrontEnd/birdhouse.png",
        "dataType": "str",
        "ret": "img",
        "parameter1": "{\"name\":\"resize\",\"parameters\":[-1,50,\"Jimp.RESIZE_BILINEAR\"]}",
        "parameter1Type": "json",
        "parameter2": "50",
        "parameter2Type": "num",
        "parameter3": "RESIZE_BILINEAR",
        "parameter3Type": "resizeMode",
        "parameter4": "",
        "parameter4Type": "",
        "parameter5": "",
        "parameter5Type": "",
        "parameter6": "",
        "parameter6Type": "",
        "parameter7": "",
        "parameter7Type": "",
        "parameter8": "",
        "parameter8Type": "",
        "sendProperty": "payload.house",
        "parameterCount": 1,
        "jimpFunction": "batch",
        "selectedJimpFunction": {
            "name": "batch",
            "fn": "batch",
            "description": "apply one or more functions",
            "parameters": [
                {
                    "name": "options",
                    "type": "json",
                    "required": true,
                    "hint": "an object or an array of objects containing {\"name\" : \"function_name\", \"parameters\" : [x,y,z]}.  Refer to info on side panel}"
                }
            ]
        },
        "x": 1810,
        "y": 2260,
        "wires": [
            [
                "b868cd58.8d414"
            ]
        ],
        "icon": "font-awesome/fa-image"
    },
    {
        "id": "7e6237bf49335dbc",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "Reset BirdLcationGraph",
        "func": "global.set(\"trajectoryCounter\", 1);\nglobal.set(\"R\", 400);\nglobal.set(\"steps\", 80);\nglobal.set(\"addHouse\", false);\nglobal.set(\"pos\", []);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1610,
        "y": 2160,
        "wires": [
            []
        ]
    },
    {
        "id": "69f11c096294323f",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "55ea67ed8f6efe15",
        "name": "Init : Bird Trajectory",
        "links": [
            "c8caecc46da13eb1"
        ],
        "x": 1455,
        "y": 2180,
        "wires": [
            [
                "7e6237bf49335dbc",
                "362f7dc1cb0b61b5"
            ]
        ]
    },
    {
        "id": "bc430912b533d2cc",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "Reload",
        "group": "e09affd1d78f162d",
        "order": 7,
        "width": 1,
        "height": 2,
        "passthru": true,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-repeat fa-lg",
        "payload": "Reload",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 2720,
        "y": 1480,
        "wires": [
            [
                "de89378993b205b2"
            ]
        ]
    },
    {
        "id": "ba56abc75de9eade",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2760,
        "y": 1560,
        "wires": [
            [
                "0900b6a64aa894b5"
            ]
        ]
    },
    {
        "id": "de89378993b205b2",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "d8498c485785607b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 2740,
        "y": 1520,
        "wires": [
            [
                "a8865b9e2ca35101",
                "ba56abc75de9eade"
            ]
        ]
    },
    {
        "id": "603126b806f758d3",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "e4d1dce20abccbef",
        "name": "Download Bird",
        "group": "6aaf1c6d6ce702b7",
        "order": 4,
        "width": 8,
        "height": 1,
        "passthru": false,
        "label": "Descargar Datos del Ave",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 3200,
        "y": 1180,
        "wires": [
            [
                "44e27602f907a70b"
            ]
        ]
    },
    {
        "id": "44e27602f907a70b",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "e4d1dce20abccbef",
        "name": "Download Data",
        "func": "return { payload: msg.payload, url: \"/files/BirdData.csv\", notification_to_user: \"Iniciando descarga.\" };",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3380,
        "y": 1180,
        "wires": [
            [
                "ca82df86ea757a04"
            ]
        ]
    },
    {
        "id": "ca82df86ea757a04",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "e4d1dce20abccbef",
        "name": "Start Download",
        "func": "msg.payload = '<!DOCTYPE html><html><head><title>Redirect url to node-red forum</title></head><body>' + msg.notification_to_user + '<script>var url= \"' + msg.url + '\"; window.location = url; </script></body></html>';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3200,
        "y": 1220,
        "wires": [
            [
                "9461d19020cb1c5a"
            ]
        ]
    },
    {
        "id": "9461d19020cb1c5a",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "e4d1dce20abccbef",
        "position": "top right",
        "displayTime": "1",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "topic": "",
        "name": "",
        "x": 3390,
        "y": 1220,
        "wires": []
    },
    {
        "id": "b10999fbcd8fea55",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "command": "cd /home/pi/simfs/simfs_export_data/ && raspistill -w 640 -h 480 -n -q 50 -v ",
        "addpay": "payload",
        "append": "",
        "useSpawn": "false",
        "timer": "30",
        "winHide": false,
        "oldrc": false,
        "name": "Take Photo",
        "x": 1750,
        "y": 2580,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "42e81d3672620c1a",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "name": "Sin Filtro",
        "func": "var file_name = flow.get('timeRTC').replace(/:/g, '-');\nvar toReturn = { payload: '-o ImagenDevSF_' + file_name + '.png' };\n\nvar lum = flow.get('lastLum') || 0;\nvar photoNight = flow.get('photoNight') || 0;\n\nreturn toReturn;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1580,
        "y": 2540,
        "wires": [
            [
                "b10999fbcd8fea55"
            ]
        ]
    },
    {
        "id": "c6a3a6353abeed1d",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "name": "Con Filtro",
        "func": "var file_name = flow.get('timeRTC').replace(/:/g, '-');\nvar toReturn = { payload: '-ex night -o ImagenDevCF_' + file_name + '.png' };\n\nvar lum = flow.get('lastLum') || 0;\nvar photoNight = flow.get('photoNight') || 0;\n\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1580,
        "y": 2620,
        "wires": [
            [
                "b10999fbcd8fea55"
            ]
        ]
    },
    {
        "id": "d939fd86d2496767",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1440,
        "y": 2540,
        "wires": [
            [
                "42e81d3672620c1a"
            ]
        ]
    },
    {
        "id": "6c8fafe779723f25",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1440,
        "y": 2620,
        "wires": [
            [
                "c6a3a6353abeed1d"
            ]
        ]
    },
    {
        "id": "14091502ce1dda92",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1440,
        "y": 2680,
        "wires": [
            [
                "73c01fbb82760324"
            ]
        ]
    },
    {
        "id": "73c01fbb82760324",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "d38a2bbf9d27a11c",
        "command": "cd /home/pi/simfs/simfs_export_data/ && rm ImagenDev*",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "5",
        "winHide": false,
        "oldrc": false,
        "name": "Delete ImgDev",
        "x": 1740,
        "y": 2680,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "34efba9cba4dcbf1",
        "type": "ui_button",
        "z": "4bd3f7a138ab9bf8",
        "g": "ca2e56985aed1ae2",
        "name": "Reload PNG",
        "group": "6aaf1c6d6ce702b7",
        "order": 2,
        "width": 8,
        "height": 1,
        "passthru": true,
        "label": "Refrescar imágenes",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "connect",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1610,
        "y": 1580,
        "wires": [
            [
                "659dd377658b5f9b"
            ]
        ]
    },
    {
        "id": "910278e5e8f63c15",
        "type": "delay",
        "z": "4bd3f7a138ab9bf8",
        "g": "b28fbac2d58cd3cf",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1710,
        "y": 780,
        "wires": [
            [
                "c8caecc46da13eb1",
                "02bfb4fbc2df5ea5"
            ]
        ]
    },
    {
        "id": "a2ec51133add780f",
        "type": "trigger",
        "z": "4bd3f7a138ab9bf8",
        "g": "9fa822970d0e02a2",
        "name": "",
        "op1": "connect",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "connect",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 2220,
        "y": 580,
        "wires": [
            [
                "c6a9736beb8ca4a1"
            ]
        ]
    },
    {
        "id": "626b960698c625cb",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "ef4d0af07249ef87",
        "command": "cd /home/pi/simfs/simfs_export_data/ && rm *.png~",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "30",
        "winHide": false,
        "oldrc": false,
        "name": "Delete Fail Photos",
        "x": 3290,
        "y": 440,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "0d0875ef01a75d96",
        "type": "exec",
        "z": "4bd3f7a138ab9bf8",
        "g": "d08f9a2c4e6b9e9b",
        "command": "node-red-restart",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Restart Node Red",
        "x": 950,
        "y": 2360,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "abf294cc6d0f2417",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "name": "Refresh",
        "func": "let toReturn = { url: \"http://192.168.0.10:1880/\", notification_to_user: \"Reiniciando\" };\n\nreturn toReturn;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 2420,
        "wires": [
            [
                "3d6ce2d1d07ebbb9"
            ]
        ]
    },
    {
        "id": "3d6ce2d1d07ebbb9",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "name": "Notification",
        "func": "msg.payload = '<!DOCTYPE html><html><head><title>Redirect url to node-red forum</title></head><body>' + msg.notification_to_user + '<script>var url= \"' + msg.url + '\"; window.location = url; </script></body></html>';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 2460,
        "wires": [
            [
                "a0aa0247a6243420"
            ]
        ]
    },
    {
        "id": "a0aa0247a6243420",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "position": "top right",
        "displayTime": "0",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "",
        "x": 950,
        "y": 2500,
        "wires": []
    },
    {
        "id": "a1d4aa1ed5dc2310",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "position": "dialog",
        "displayTime": "1",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Continuar",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "Restart",
        "x": 700,
        "y": 2420,
        "wires": [
            [
                "0d0875ef01a75d96",
                "abf294cc6d0f2417"
            ]
        ]
    },
    {
        "id": "12d5c7559df89c2f",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "name": "Restart",
        "func": "msg.payload = \"Reiniciando servidor. Esto tardará unos segundos. Pueden experimentarse desconexiones. Por favor, presione para continuar.\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 2460,
        "wires": [
            [
                "a1d4aa1ed5dc2310"
            ]
        ]
    },
    {
        "id": "608c40df0e9ca09d",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "d": true,
        "g": "d08f9a2c4e6b9e9b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 700,
        "y": 2500,
        "wires": [
            [
                "12d5c7559df89c2f"
            ]
        ]
    },
    {
        "id": "1131c53852adac45",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "d08f9a2c4e6b9e9b",
        "name": "Reboot every 4 h",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "14400",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 690,
        "y": 2360,
        "wires": [
            [
                "0d0875ef01a75d96"
            ]
        ]
    },
    {
        "id": "152f105603eccf50",
        "type": "inject",
        "z": "4bd3f7a138ab9bf8",
        "g": "d08f9a2c4e6b9e9b",
        "name": "Force Restart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 710,
        "y": 2320,
        "wires": [
            [
                "0d0875ef01a75d96"
            ]
        ]
    },
    {
        "id": "748efb437466a4f4",
        "type": "debug",
        "z": "4bd3f7a138ab9bf8",
        "g": "2b12209bde62c41d",
        "name": "Bird Presence",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2540,
        "y": 1100,
        "wires": []
    },
    {
        "id": "d638eef8be7f1dc8",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "name": "Refresh",
        "func": "if (msg.payload == \"OK\") {\n    let toReturn = { url: \"http://192.168.0.10:1880/\", notification_to_user: \"Reiniciando\" };\n    return toReturn;\n}\n\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2940,
        "y": 760,
        "wires": [
            [
                "674ef304a2ca14b2"
            ]
        ]
    },
    {
        "id": "674ef304a2ca14b2",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "name": "Notification",
        "func": "msg.payload = '<!DOCTYPE html><html><head><title>Redirect url to node-red forum</title></head><body>' + msg.notification_to_user + '<script>var url= \"' + msg.url + '\"; window.location = url; </script></body></html>';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3090,
        "y": 760,
        "wires": [
            [
                "f4dbec9993651d14"
            ]
        ]
    },
    {
        "id": "f4dbec9993651d14",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "position": "top right",
        "displayTime": "0",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "",
        "x": 3270,
        "y": 760,
        "wires": []
    },
    {
        "id": "f8dab95a90ac6799",
        "type": "function",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "name": "RTC Error",
        "func": "let recieve = flow.get('handleRTCError') || 0;\n\nif ((msg.payload.code == 1) && recieve) {\n    flow.set('handleRTCError', false);\n    return { payload: \"Error de conexión de sensores. Verificar conexionado.\" };\n}\n\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2630,
        "y": 760,
        "wires": [
            [
                "50da0b27953103d8"
            ]
        ]
    },
    {
        "id": "50da0b27953103d8",
        "type": "ui_toast",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2790,
        "y": 760,
        "wires": [
            [
                "d638eef8be7f1dc8"
            ]
        ]
    },
    {
        "id": "6dfdf11c017fee5f",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "name": "F5: RTC Error",
        "links": [
            "2e7ddfebe958c635"
        ],
        "x": 2575,
        "y": 800,
        "wires": [
            [
                "2b1bbe4391992523"
            ]
        ]
    },
    {
        "id": "2b1bbe4391992523",
        "type": "change",
        "z": "4bd3f7a138ab9bf8",
        "g": "7c86f6078e91083c",
        "name": "Set Handle RTC Error",
        "rules": [
            {
                "t": "set",
                "p": "handleRTCError",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2760,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "4a61374005642b4b",
        "type": "watch",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Watch LastData.json",
        "files": "/home/pi/LastData/last_data.json",
        "recursive": "",
        "x": 1750,
        "y": 1820,
        "wires": [
            [
                "3d07738b4f1aa41c"
            ]
        ]
    },
    {
        "id": "919b936bbb8109c5",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "Init And F5: Current Data",
        "links": [
            "c1d45c05dcc2f331"
        ],
        "x": 1705,
        "y": 1780,
        "wires": [
            [
                "3d07738b4f1aa41c"
            ]
        ]
    },
    {
        "id": "5ca3955143dc7c09",
        "type": "link in",
        "z": "4bd3f7a138ab9bf8",
        "g": "0f2a2139fe8d7ca1",
        "name": "F5: Current Data",
        "links": [
            "2e7ddfebe958c635"
        ],
        "x": 1705,
        "y": 1740,
        "wires": [
            [
                "ef32280e152b2d7c",
                "3d07738b4f1aa41c"
            ]
        ]
    },
    {
        "id": "e2b8412e38894d84",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "c63655b8f7450c5c",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "f51b903c82d25165",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "6b5e5887ee54b112",
        "order": 2,
        "width": 2,
        "height": 1
    },
    {
        "id": "816ee2cb60b10f55",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "6b5e5887ee54b112",
        "order": 4,
        "width": 2,
        "height": 1
    },
    {
        "id": "21e3991ee0779589",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "6b5e5887ee54b112",
        "order": 6,
        "width": 2,
        "height": 1
    },
    {
        "id": "45e1551fac9a56f7",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "6b5e5887ee54b112",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "dbe6ad483e325677",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "74524b4a677dedb8",
        "order": 2,
        "width": 2,
        "height": 1
    },
    {
        "id": "eae195521f86f2d2",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "74524b4a677dedb8",
        "order": 4,
        "width": 2,
        "height": 1
    },
    {
        "id": "94c10c8fb20dc96d",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "b4be47d1fa09bf5e",
        "order": 2,
        "width": 2,
        "height": 1
    },
    {
        "id": "74799cc269a17f28",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "5f21bab708c4b0d2",
        "order": 3,
        "width": 18,
        "height": 1
    },
    {
        "id": "3f34bb39be56cf12",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 4,
        "width": 2,
        "height": 1
    },
    {
        "id": "70fe62ddef0ee04a",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "85da6447556a0731",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 11,
        "width": 2,
        "height": 1
    },
    {
        "id": "27e4c2b4e6921154",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 12,
        "width": 1,
        "height": 1
    },
    {
        "id": "600162a4aac95702",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 13,
        "width": 3,
        "height": 1
    },
    {
        "id": "a2b57b32a978bc2b",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 15,
        "width": 2,
        "height": 1
    },
    {
        "id": "4f6e40664f25b7a6",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 16,
        "width": 3,
        "height": 1
    },
    {
        "id": "2f2e410c387c11af",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 17,
        "width": 2,
        "height": 1
    },
    {
        "id": "ca7ba15ffd706086",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 18,
        "width": 3,
        "height": 1
    },
    {
        "id": "616a164e62fab9ab",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 19,
        "width": 2,
        "height": 1
    },
    {
        "id": "9b67d36067a6760c",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 20,
        "width": 3,
        "height": 1
    },
    {
        "id": "abe88cb7080adb28",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 21,
        "width": 2,
        "height": 1
    },
    {
        "id": "f01dea9f0457239e",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 22,
        "width": 3,
        "height": 1
    },
    {
        "id": "5fe6e0d1f1778b7f",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 23,
        "width": 2,
        "height": 1
    },
    {
        "id": "9986ba844f7f8842",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 24,
        "width": 3,
        "height": 1
    },
    {
        "id": "e74faa6a183ab403",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 25,
        "width": 2,
        "height": 1
    },
    {
        "id": "23b0a8acddd3482c",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 26,
        "width": 3,
        "height": 1
    },
    {
        "id": "40e77fe5aa6b0f0e",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 27,
        "width": 2,
        "height": 1
    },
    {
        "id": "1db45a2d989a34d4",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 28,
        "width": 3,
        "height": 1
    },
    {
        "id": "cedf55b1c4279ada",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 29,
        "width": 2,
        "height": 1
    },
    {
        "id": "c4541b35e3c0a592",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 30,
        "width": 3,
        "height": 1
    },
    {
        "id": "13df0acd27c22e47",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 31,
        "width": 2,
        "height": 1
    },
    {
        "id": "74a01e6b93fb2375",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 32,
        "width": 3,
        "height": 1
    },
    {
        "id": "2ceb808cfe63c1bc",
        "type": "ui_spacer",
        "z": "4bd3f7a138ab9bf8",
        "name": "spacer",
        "group": "e09affd1d78f162d",
        "order": 33,
        "width": 2,
        "height": 1
    },
    {
        "id": "e09affd1d78f162d",
        "type": "ui_group",
        "name": "Data Panel",
        "tab": "48418b79.0f5834",
        "order": 4,
        "disp": false,
        "width": "18",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6aaf1c6d6ce702b7",
        "type": "ui_group",
        "name": "Download Buttons",
        "tab": "1398b28725890a06",
        "order": 4,
        "disp": false,
        "width": 24,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c63655b8f7450c5c",
        "type": "ui_group",
        "name": "Code Templates",
        "tab": "08c443aaea74f446",
        "order": 5,
        "disp": false,
        "width": "1",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f44b173abdb7e275",
        "type": "ui_group",
        "name": "Luminosidad",
        "tab": "1398b28725890a06",
        "order": 1,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "4ad91a62eed23859",
        "type": "ui_group",
        "name": "Temperatura y Humedad",
        "tab": "1398b28725890a06",
        "order": 3,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "ed493faf50b74f04",
        "type": "ui_group",
        "name": "Imágenes",
        "tab": "1398b28725890a06",
        "order": 2,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "6b5e5887ee54b112",
        "type": "ui_group",
        "name": "Configuración de Fotos",
        "tab": "f4ca2bdf513f0f05",
        "order": 1,
        "disp": true,
        "width": 10,
        "collapse": false,
        "className": ""
    },
    {
        "id": "74524b4a677dedb8",
        "type": "ui_group",
        "name": "Configuración de Temperatra y Humedad",
        "tab": "f4ca2bdf513f0f05",
        "order": 2,
        "disp": true,
        "width": 10,
        "collapse": false,
        "className": ""
    },
    {
        "id": "b4be47d1fa09bf5e",
        "type": "ui_group",
        "name": "Configuración de Luminosidad",
        "tab": "f4ca2bdf513f0f05",
        "order": 3,
        "disp": true,
        "width": 10,
        "collapse": false,
        "className": ""
    },
    {
        "id": "5f21bab708c4b0d2",
        "type": "ui_group",
        "name": "Presencia del Ave",
        "tab": "9257b746f7bd67a1",
        "order": 1,
        "disp": true,
        "width": 25,
        "collapse": false,
        "className": ""
    },
    {
        "id": "4f44b35e1169a30d",
        "type": "ui_group",
        "name": "Mapa de la zona",
        "tab": "9257b746f7bd67a1",
        "order": 2,
        "disp": true,
        "width": 25,
        "collapse": false,
        "className": ""
    },
    {
        "id": "48418b79.0f5834",
        "type": "ui_tab",
        "name": "Nido en Vivo",
        "icon": "fa-user-circle-o",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "1398b28725890a06",
        "type": "ui_tab",
        "name": "Descarga de Datos",
        "icon": "fa-download",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "08c443aaea74f446",
        "type": "ui_tab",
        "name": "Code Templates",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": true
    },
    {
        "id": "f4ca2bdf513f0f05",
        "type": "ui_tab",
        "name": "Configuración",
        "icon": "fa-cog",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "9257b746f7bd67a1",
        "type": "ui_tab",
        "name": "Datos del Ave",
        "icon": "fa-binoculars",
        "order": 2,
        "disabled": false,
        "hidden": false
    }
]